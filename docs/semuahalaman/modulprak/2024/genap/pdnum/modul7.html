<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modul 7 Persamaan Diferensial Numerik: Nonlinear Finite Difference, PDP Eliptik &amp; Hiperbolik – Lab Praktikum Departemen Matematika FMIPA UI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Lab Praktikum Departemen Matematika FMIPA UI</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../semuahalaman/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../semuahalaman/praktikum.html"> 
<span class="menu-text">Praktikum</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../semuahalaman/Announcement.html"> 
<span class="menu-text">Announcement</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#nonlinear-finite-difference" id="toc-nonlinear-finite-difference" class="nav-link active" data-scroll-target="#nonlinear-finite-difference"><em>Nonlinear Finite Difference</em></a>
  <ul class="collapse">
  <li><a href="#function-file-dengan-solusi-spl-secara-langsung" id="toc-function-file-dengan-solusi-spl-secara-langsung" class="nav-link" data-scroll-target="#function-file-dengan-solusi-spl-secara-langsung"><em>Function file</em> (dengan solusi SPL secara langsung)</a></li>
  <li><a href="#contoh-1" id="toc-contoh-1" class="nav-link" data-scroll-target="#contoh-1">Contoh 1</a></li>
  <li><a href="#contoh-2" id="toc-contoh-2" class="nav-link" data-scroll-target="#contoh-2">Contoh 2</a></li>
  </ul></li>
  <li><a href="#plot-tiga-dimensi-dan-grid" id="toc-plot-tiga-dimensi-dan-grid" class="nav-link" data-scroll-target="#plot-tiga-dimensi-dan-grid">Plot tiga dimensi dan <em>grid</em></a></li>
  <li><a href="#pdp-eliptiklaplacepoisson" id="toc-pdp-eliptiklaplacepoisson" class="nav-link" data-scroll-target="#pdp-eliptiklaplacepoisson">PDP Eliptik/Laplace/Poisson</a>
  <ul class="collapse">
  <li><a href="#bentuk-umum-persamaan-laplace" id="toc-bentuk-umum-persamaan-laplace" class="nav-link" data-scroll-target="#bentuk-umum-persamaan-laplace">Bentuk umum persamaan Laplace</a></li>
  <li><a href="#ide-utama" id="toc-ide-utama" class="nav-link" data-scroll-target="#ide-utama">Ide utama</a></li>
  <li><a href="#penggunaan-metode-gauss-seidel" id="toc-penggunaan-metode-gauss-seidel" class="nav-link" data-scroll-target="#penggunaan-metode-gauss-seidel">Penggunaan metode Gauss-Seidel</a></li>
  <li><a href="#function-file" id="toc-function-file" class="nav-link" data-scroll-target="#function-file"><em>Function file</em></a></li>
  <li><a href="#contoh-1-1" id="toc-contoh-1-1" class="nav-link" data-scroll-target="#contoh-1-1">Contoh 1</a></li>
  <li><a href="#contoh-2-1" id="toc-contoh-2-1" class="nav-link" data-scroll-target="#contoh-2-1">Contoh 2</a></li>
  </ul></li>
  <li><a href="#pdp-hiperbolik-persamaan-gelombang" id="toc-pdp-hiperbolik-persamaan-gelombang" class="nav-link" data-scroll-target="#pdp-hiperbolik-persamaan-gelombang">PDP Hiperbolik / Persamaan Gelombang</a>
  <ul class="collapse">
  <li><a href="#bentuk-umum-persamaan-gelombang" id="toc-bentuk-umum-persamaan-gelombang" class="nav-link" data-scroll-target="#bentuk-umum-persamaan-gelombang">Bentuk umum persamaan gelombang</a></li>
  <li><a href="#ide-utama-1" id="toc-ide-utama-1" class="nav-link" data-scroll-target="#ide-utama-1">Ide utama</a></li>
  <li><a href="#function-file-1" id="toc-function-file-1" class="nav-link" data-scroll-target="#function-file-1"><em>Function file</em></a></li>
  <li><a href="#contoh-1-2" id="toc-contoh-1-2" class="nav-link" data-scroll-target="#contoh-1-2">Contoh 1</a></li>
  <li><a href="#contoh-2-2" id="toc-contoh-2-2" class="nav-link" data-scroll-target="#contoh-2-2">Contoh 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modul 7 Persamaan Diferensial Numerik: <em>Nonlinear Finite Difference</em>, PDP Eliptik &amp; Hiperbolik</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Kembali ke <a href="../../../../../semuahalaman/modulprak/2024/genap/pdnum/pdnum2024genap.html">Persamaan Diferensial Numerik</a></p>
<p>Melanjutkan dari modul sebelumnya, untuk masalah nilai batas PDB, kita akan membahas metode</p>
<ul>
<li><em>Nonlinear Finite Difference</em></li>
</ul>
<p>Kemudian, kita akan membahas metode numerik untuk menyelesaikan PDP (persamaan diferensial parsial) orde 2</p>
<ul>
<li><p>yang eliptik (persamaan Laplace / persamaan Poisson); dan</p></li>
<li><p>yang hiperbolik (persamaan gelombang).</p></li>
</ul>
<section id="nonlinear-finite-difference" class="level2">
<h2 class="anchored" data-anchor-id="nonlinear-finite-difference"><em>Nonlinear Finite Difference</em></h2>
<p>Metode ini digunakan untuk mengaproksimasi masalah nilai batas:</p>
<p><span class="math display">\[
\begin{gathered}
y^{\prime \prime}=f\left(x, y, y^{\prime}\right), \quad a \leq x \leq b \\
y(a)=\alpha, \quad y(b)=\beta
\end{gathered}
\]</span></p>
<p>dengan <span class="math inline">\(f\)</span> boleh berupa fungsi linier maupun nonlinier.</p>
<p>Metode ini bersifat iteratif, memanfaatkan yang namanya “metode Newton untuk sistem” yang dibahas di subbab 10.2 buku Burden, yang dibahas di mata kuliah Matematika Numerik. Daripada membahas secara umum mengenai metode Newton untuk sistem, kita cukup membahas bagaimana langkah-langkah metodenya khusus dalam penerapannya sebagai metode <em>nonlinear finite difference</em> untuk menyelesaikan masalah nilai batas.</p>
<p>Langkah-langkah metode <em>nonlinear finite difference</em> bisa ditulis sebagai berikut:</p>
<ol type="1">
<li><p>Hitung rumus <span class="math inline">\(f_y(x,y,y')\)</span> (yaitu <span class="math inline">\(\frac{\partial f}{\partial y}(x,y,y')\)</span>) dan rumus <span class="math inline">\(f_{y'}(x,y,y')\)</span> (yaitu <span class="math inline">\(\frac{\partial f}{\partial y'}(x,y,y')\)</span>) secara analitik.</p></li>
<li><p>Tentukan toleransi <span class="math inline">\(\varepsilon\)</span>, dan/atau maksimum banyaknya iterasi <span class="math inline">\(M\)</span>.</p></li>
<li><p>Pastikan nilai <span class="math inline">\(N\)</span> dan <em>step size</em> <span class="math inline">\(h\)</span> sudah dimiliki. Biasanya hanya salah satu nilai yang diberikan (biasanya <span class="math inline">\(N\)</span>). Hubungan antara keduanya adalah</p>
<p><span class="math display">\[h = \frac{b-a}{N+1}\]</span></p></li>
<li><p>Ingat bahwa <span class="math inline">\(w_0 = \alpha\)</span> dan <span class="math inline">\(w_{N+1} = \beta\)</span>. Kita perlu menentukan nilai-nilai <span class="math inline">\(w_1, \dots, w_N\)</span>. Untuk nilai-nilai tersebut, pasang tebakan awal, berupa nilai-nilai di antara <span class="math inline">\(\alpha\)</span> dan <span class="math inline">\(\beta\)</span>, sebagai berikut untuk <span class="math inline">\(i = 1, \dots, N\)</span>:</p>
<p><span class="math display">\[w_i = \alpha + i\left(\frac{\beta - \alpha}{b-a}\right)h\]</span></p></li>
<li><p>Susun suatu matriks tridiagonal berukuran <span class="math inline">\(N \times N\)</span> yang dinamakan matriks Jacobian, dengan entri <span class="math display">\[J_{ij} = \begin{cases}
     -\left(1 + \frac{h}{2} f_{y'} \left(x_i, w_i, \frac{w_{i+1} - w_{i-1}}{2h}\right)\right) &amp; \text{di bawah/kiri diagonal, baris ke-$i$} \\
     2 + h^2 f_{y} \left(x_i, w_i, \frac{w_{i+1} - w_{i-1}}{2h}\right) &amp; \text{di diagonal, baris ke-$i$} \\
     -\left(1 - \frac{h}{2} f_{y'} \left(x_i, w_i, \frac{w_{i+1} - w_{i-1}}{2h}\right) \right) &amp; \text{di atas/kanan diagonal, barsi ke-$i$} \\
     0 &amp; \text{untuk semua elemen lainnya}
\end{cases}\]</span></p></li>
<li><p>Susun vektor kolom bernama <span class="math inline">\(d\)</span> dengan <span class="math inline">\(N\)</span> baris, yang isinya sebagai berikut untuk <span class="math inline">\(i = 1, \dots, N\)</span>: <span class="math display">\[d_i = -w_{i-1} + 2w_i - w_{i+1} + h^2 f\left(x_i, w_i, \frac{w_{i+1}-w_{i-1}}{2h}\right)\]</span></p></li>
<li><p>Selesaikan SPL <span class="math inline">\(Jv = -d\)</span> (iya pakai minus), di mana vektor <span class="math inline">\(v\)</span> berisi nilai-nilai <span class="math inline">\(v_1,\dots,v_N\)</span> yang ingin diperoleh. Metode penyelesaian SPLnya terserah.</p></li>
<li><p>Perbarui vektor <span class="math inline">\(w\)</span> dengan menambahkan vektor <span class="math inline">\(v\)</span>. Yaitu, nilai <span class="math inline">\(w_1\)</span> ditambahkan <span class="math inline">\(v_1\)</span>, nilai <span class="math inline">\(w_2\)</span> ditambahkan <span class="math inline">\(v_2\)</span>, dan seterusnya.</p></li>
<li><p>Sampai sini, selesai satu iterasi. Periksa apakah <span class="math inline">\(\left|\left|v\right|\right| \le \varepsilon\)</span> (atau periksa apakah sudah memenuhi banyaknya iterasi yang diminta). Kalau sudah terpenuhi, metode selesai. Kalau belum, masuk ke iterasi selanjutnya, yaitu melanjutkan kembali dari langkah 5, dengan nilai-nilai <span class="math inline">\(w_1, \dots, w_N\)</span> terbaru.</p></li>
</ol>
<section id="function-file-dengan-solusi-spl-secara-langsung" class="level3">
<h3 class="anchored" data-anchor-id="function-file-dengan-solusi-spl-secara-langsung"><em>Function file</em> (dengan solusi SPL secara langsung)</h3>
<p>Berikut ini, matriks Jacobian disusun dengan mempertimbangkan tiap elemen matriks, sehingga kompleksiasnya bisa dianggap <span class="math inline">\(O(N^2)\)</span>:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><em>Function file</em> <code>nonlinear_fd_langsung_on2.m</code> - nama <em>file</em> harus sama dengan nama fungsi</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="cell-14" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x_grid<span class="op">,</span> w_grid] <span class="op">=</span> nonlinear_fd_langsung_on2(f<span class="op">,</span> fy<span class="op">,</span> fyp<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet<span class="op">,</span> tol<span class="op">,</span> M)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  h <span class="op">=</span> (b<span class="op">-</span>a) <span class="op">/</span> (N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  x_grid <span class="op">=</span> (a <span class="op">:</span> h <span class="op">:</span> b)<span class="op">';</span> <span class="co">% transpos juga agar menjadi vektor kolom</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> x_grid(<span class="fl">2</span> <span class="op">:</span> N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> <span class="fu">zeros</span>(N<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> N</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span>) <span class="op">=</span> alph <span class="op">+</span> <span class="fu">i</span> <span class="op">*</span> ((bet <span class="op">-</span> alph)<span class="op">/</span>(b<span class="op">-</span>a)) <span class="op">*</span> h<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">% banyaknya iterasi</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  k <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  err <span class="op">=</span> tol <span class="op">+</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">% selama belum memenuhi toleransi ataupun mencapai batas iterasi</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="op">!</span>(err <span class="op">&lt;=</span> tol) <span class="op">&amp;&amp;</span> k <span class="op">!=</span> M<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">% menyusun matriks Jacobian</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    matriks_J <span class="op">=</span> <span class="fu">zeros</span>(N<span class="op">,</span> N)<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> N</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> N</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fu">j</span><span class="op">+</span><span class="fl">1</span>) <span class="co">% kiri/bawah diagonal</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fl">1</span>) <span class="co">% w(0) = alfa</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> alph)<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>          <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">==</span> N) <span class="co">% w(N+1) = beta</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (bet <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>          <span class="cf">else</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">endif</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fu">j</span>) <span class="co">% pada diagonal</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fl">1</span>) <span class="co">% w(0) = alfa</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> fy(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> alph)<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>          <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">==</span> N) <span class="co">% w(N+1) = beta</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> fy(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (bet <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>          <span class="cf">else</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> fy(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>          <span class="cf">endif</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fu">j</span><span class="op">-</span><span class="fl">1</span>) <span class="co">% kanan/atas diagonal</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fl">1</span>) <span class="co">% w(0) = alfa</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> alph)<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>          <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">==</span> N) <span class="co">% w(N+1) = beta</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (bet <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>          <span class="cf">else</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>          <span class="cf">endif</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>          matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">endif</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">endfor</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">% menyusun vektor d</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="fu">zeros</span>(N<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">% khusus baris pertama</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    d(<span class="fu">i</span>) <span class="op">=</span> <span class="op">-</span>alph <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> w(<span class="fu">i</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> f(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> alph)<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> (N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>      d(<span class="fu">i</span>) <span class="op">=</span> <span class="op">-</span>w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> w(<span class="fu">i</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> f(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">% khusus baris terakhir</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">i</span> <span class="op">=</span> N<span class="op">;</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    d(<span class="fu">i</span>) <span class="op">=</span> <span class="op">-</span>w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> w(<span class="fu">i</span>) <span class="op">-</span> bet <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> f(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (bet <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">% selesaikan SPL</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> matriks_J <span class="op">\</span> (<span class="op">-</span>d)<span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">% update w</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> w <span class="op">+</span> v<span class="op">;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="co">% hitung error dengan norm Euclid</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    err <span class="op">=</span> <span class="fu">sum</span>(v<span class="op">.^</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    k <span class="op">+=</span> <span class="fl">1</span><span class="op">;</span> <span class="co">% lanjut ke iterasi selanjutnya</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endwhile</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">% gabungkan w_0 (alfa), dengan w_1, ..., w_N, dengan w_{N+1} (beta)</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  w_grid <span class="op">=</span> [alph<span class="op">;</span> w<span class="op">;</span> bet]<span class="op">;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Daripada mempertimbangkan tiap elemen di matriks Jacobian, kita bisa isi matriksnya dengan nol semua terlebih dahulu, kemudian melihat per baris saja dan hanya mempertimbangkan elemen diagonal dan kolom sebelum/setelah diagonal (karena matriksnya tridiagonal). Kodenya menjadi seperti berikut:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><em>Function file</em> <code>nonlinear_fd_langsung.m</code> - nama <em>file</em> harus sama dengan nama fungsi</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div id="cell-18" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x_grid<span class="op">,</span> w_grid] <span class="op">=</span> nonlinear_fd_langsung(f<span class="op">,</span> fy<span class="op">,</span> fyp<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet<span class="op">,</span> tol<span class="op">,</span> M)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  h <span class="op">=</span> (b<span class="op">-</span>a) <span class="op">/</span> (N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  x_grid <span class="op">=</span> (a <span class="op">:</span> h <span class="op">:</span> b)<span class="op">';</span> <span class="co">% transpos juga agar menjadi vektor kolom</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> x_grid(<span class="fl">2</span> <span class="op">:</span> N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> <span class="fu">zeros</span>(N<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> N</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span>) <span class="op">=</span> alph <span class="op">+</span> <span class="fu">i</span> <span class="op">*</span> ((bet <span class="op">-</span> alph)<span class="op">/</span>(b<span class="op">-</span>a)) <span class="op">*</span> h<span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">% banyaknya iterasi</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  k <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  err <span class="op">=</span> tol <span class="op">+</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">% selama belum memenuhi toleransi ataupun mencapai batas iterasi</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="op">!</span>(err <span class="op">&lt;=</span> tol) <span class="op">&amp;&amp;</span> k <span class="op">!=</span> M<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">% menyusun matriks Jacobian</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    matriks_J <span class="op">=</span> <span class="fu">zeros</span>(N<span class="op">,</span> N)<span class="op">;</span> <span class="co">% isi nol semua dulu</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> N <span class="co">% untuk tiap baris ke-i, dengan i = 1, ..., N</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="co">% kiri/bawah diagonal (kecuali di baris pertama)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">i</span> <span class="op">==</span> N) <span class="co">% w(N+1) = beta</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (bet <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">!=</span> <span class="fl">1</span>) <span class="co">% rumus biasa</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">endif</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      <span class="co">% pada diagonal</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fl">1</span>) <span class="co">% w(0) = alfa</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span>) <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> fy(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> alph)<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">==</span> N) <span class="co">% w(N+1) = beta</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span>) <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> fy(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (bet <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="co">% rumus biasa</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span>) <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> fy(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">endif</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="co">% kanan/atas diagonal (kecuali di baris terakhir)</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">i</span> <span class="op">==</span> <span class="fl">1</span>) <span class="co">% w(0) = alfa</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>        matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> alph)<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elseif</span> (<span class="fu">i</span> <span class="op">!=</span> N) <span class="co">% rumus biasa</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        matriks_J(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> <span class="op">-</span>(<span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> fyp(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h)))<span class="op">;</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">endif</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">% menyusun vektor d</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="fu">zeros</span>(N<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">% khusus baris pertama</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    d(<span class="fu">i</span>) <span class="op">=</span> <span class="op">-</span>alph <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> w(<span class="fu">i</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> f(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> alph)<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> (N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>      d(<span class="fu">i</span>) <span class="op">=</span> <span class="op">-</span>w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> w(<span class="fu">i</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> f(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">% khusus baris terakhir</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">i</span> <span class="op">=</span> N<span class="op">;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    d(<span class="fu">i</span>) <span class="op">=</span> <span class="op">-</span>w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> w(<span class="fu">i</span>) <span class="op">-</span> bet <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> f(x(<span class="fu">i</span>)<span class="op">,</span> w(<span class="fu">i</span>)<span class="op">,</span> (bet <span class="op">-</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>(<span class="fl">2</span><span class="op">*</span>h))<span class="op">;</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">% selesaikan SPL</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> matriks_J <span class="op">\</span> (<span class="op">-</span>d)<span class="op">;</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">% update w</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> w <span class="op">+</span> v<span class="op">;</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">% hitung error dengan norm L2 (Euclid)</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    err <span class="op">=</span> <span class="fu">sum</span>(v<span class="op">.^</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    k <span class="op">+=</span> <span class="fl">1</span><span class="op">;</span> <span class="co">% lanjut ke iterasi selanjutnya</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endwhile</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="co">% gabungkan w_0 (alfa), dengan w_1, ..., w_N, dengan w_{N+1} (beta)</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  w_grid <span class="op">=</span> [alph<span class="op">;</span> w<span class="op">;</span> bet]<span class="op">;</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="contoh-1" class="level3">
<h3 class="anchored" data-anchor-id="contoh-1">Contoh 1</h3>
<p>Gunakan metode beda hingga nonlinier <em>(nonlinear finite difference)</em> dengan <span class="math inline">\(h=0.1\)</span> dan toleransi <span class="math inline">\(10^{-4}\)</span> untuk mengaproksimasi <em>Boundary Value Problem</em> (BVP) / Masalah Nilai Batas (MNB) berikut: <span class="math display">\[
\begin{aligned}
y^{\prime \prime} &amp; =y^{\prime}+2(y-\ln x)^3-\frac{1}{x}, \quad 2 \leq x \leq 3 \\
y(2) &amp; =\frac{1}{2}+\ln 2, \quad y(3)=\frac{1}{3}+\ln 3
\end{aligned}
\]</span></p>
<p>Solusi eksak:</p>
<p><span class="math display">\[y(x)=\frac{1}{x}+\ln x\]</span></p>
<p>Hint:</p>
<p><span class="math display">\[y'' = f\left(x,y,y'\right) = y'+2(y-\ln x)^3-\frac{1}{x}\]</span></p>
<p><span class="math display">\[f_{y}\left(x,y,y'\right) = \frac{\partial f}{\partial y} \left(x,y,y'\right) = 6\left(y - \ln{x}\right)^2\]</span></p>
<p><span class="math display">\[f_{y'}\left(x,y,y'\right) = \frac{\partial f}{\partial y'} \left(x,y,y'\right) = 1\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><em>Script file</em> <code>coba_nonlinear_fd_langsung.m</code> - nama <em>file</em> bebas</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div id="cell-24" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> @(x<span class="op">,</span>y<span class="op">,</span>yp) yp <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>(y<span class="op">-</span><span class="fu">log</span>(x))<span class="op">.^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">1</span><span class="op">./</span>x <span class="op">;</span> <span class="co">% fungsi f pada y=f(x,y,y')</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fy <span class="op">=</span> @(x<span class="op">,</span>y<span class="op">,</span>yp) <span class="fl">6</span><span class="op">*</span>(y<span class="op">-</span><span class="fu">log</span>(x))<span class="op">.^</span><span class="fl">2</span><span class="op">;</span> <span class="co">% turunan fungsi f terhadap y</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>fyp <span class="op">=</span> @(x<span class="op">,</span>y<span class="op">,</span>yp) <span class="fl">1</span><span class="op">;</span> <span class="co">% turunan fungsi f terhadap y prime, yaitu y'</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">2</span><span class="op">;</span> <span class="co">% left boundary</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">3</span><span class="op">;</span> <span class="co">% right boundary</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">9</span><span class="op">;</span> <span class="co">% banyaknya partisi (pilih N=9 sehingga h=0.1)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>alph <span class="op">=</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">log</span>(<span class="fl">2</span>)<span class="op">;</span> <span class="co">% y(a)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>bet <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span> <span class="op">+</span> <span class="fu">log</span>(<span class="fl">3</span>)<span class="op">;</span> <span class="co">% y(b)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">4</span>)<span class="op">;</span> <span class="co">% toleransi nilai (untuk kriteria stop)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">30</span><span class="op">;</span> <span class="co">% maksimum iterasi</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span> w_grid] <span class="op">=</span> nonlinear_fd_langsung(f<span class="op">,</span> fy<span class="op">,</span> fyp<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet<span class="op">,</span> tol<span class="op">,</span> M)<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">% solusi eksak</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>sln <span class="op">=</span> @(x) <span class="fl">1</span><span class="op">./</span>x <span class="op">+</span> <span class="fu">log</span>(x)<span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>y_eksak <span class="op">=</span> sln(x_grid)<span class="op">;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">% menghitung error</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>err_w <span class="op">=</span> <span class="fu">abs</span>(y_eksak <span class="op">-</span> w_grid)<span class="op">;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>err_total <span class="op">=</span> <span class="fu">sum</span>(err_w)<span class="op">;</span> <span class="co">% norm L1 (taxicab/Manhattan)</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">% tampilkan tabel</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span> long<span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Tabel aproksimasi, solusi y(x), dan error:"</span>)<span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span> w_grid<span class="op">,</span> y_eksak<span class="op">,</span> err_w]</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Error total (norm L1):"</span>)<span class="op">;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(err_total)<span class="op">;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span><span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">hold</span> on<span class="op">;</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">fplot</span>(sln<span class="op">,</span> [a<span class="op">,</span> b]<span class="op">,</span> <span class="st">'k'</span>)<span class="op">;</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(x_grid<span class="op">,</span> w_grid<span class="op">,</span> <span class="st">'r'</span>)<span class="op">;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Aproksimasi y(x)"</span>)<span class="op">;</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"Eksak"</span><span class="op">,</span> <span class="st">"Aproksimasi"</span>)<span class="op">;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"location"</span><span class="op">,</span> <span class="st">"northwest"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tabel aproksimasi, solusi y(x), dan error:
ans =

   2.000000000000000   1.193147180559945   1.193147180559945                   0
   2.100000000000000   1.218136665897076   1.218127820919853   0.000008844977223
   2.200000000000000   1.243017438585886   1.243002814909725   0.000014623676161
   2.300000000000000   1.267709758540398   1.267691731630756   0.000018026909642
   2.400000000000000   1.292154898557824   1.292135404020567   0.000019494537257
   2.500000000000000   1.316310046093640   1.316290731874155   0.000019314219485
   2.600000000000000   1.340144522402694   1.340126829642821   0.000017692759873
   2.700000000000000   1.363636945192896   1.363622143380654   0.000014801812242
   2.800000000000000   1.386773073873609   1.386762274324015   0.000010799549594
   2.900000000000000   1.409544153003318   1.409538323199325   0.000005829803994
   3.000000000000000   1.431945622001443   1.431945622001443                   0

Error total (norm L1):
1.294282454702422e-04</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-4-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="contoh-2" class="level3">
<h3 class="anchored" data-anchor-id="contoh-2">Contoh 2</h3>
<p>Selesaikan maslaah nilai batas berikut</p>
<p><span class="math display">\[y'' = \frac{1}{8} \left(32 + 2x^3 - yy'\right), \quad 1 \le x \le 3\]</span> <span class="math display">\[y(1) = 17, \quad y(3) = \frac{43}{3}\]</span></p>
<p>dengan <span class="math inline">\(h=0.1\)</span>, toleransi <span class="math inline">\(10^{-8}\)</span>, dan maksimum iterasi <span class="math inline">\(M=30\)</span>. Bandingkan hasilnya dengan solusi eksak</p>
<p><span class="math display">\[y(x) = x^2 + \frac{16}{x}\]</span></p>
<p>Hint:</p>
<p><span class="math display">\[y'' = f(x, y, y') = \frac{1}{8} \left(32 + 2x^3 - yy'\right)\]</span></p>
<p><span class="math display">\[f_{y} (x, y, y') = \frac{\partial f}{\partial y} (x, y, y') = -\frac{1}{8} y'\]</span></p>
<p><span class="math display">\[f_{y'} (x, y, y') = \frac{\partial f}{\partial y'} (x, y, y') = -\frac{1}{8} y\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><em>Script file</em> <code>coba2_nonlinear_fd_langsung.m</code> - nama <em>file</em> bebas</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div id="cell-30" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> @(x<span class="op">,</span> y<span class="op">,</span> yp) ((<span class="fl">1</span><span class="op">/</span><span class="fl">8</span>)<span class="op">*</span>(<span class="fl">32</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> x<span class="op">.^</span><span class="fl">3</span> <span class="op">-</span> y <span class="op">.*</span> yp))<span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fy <span class="op">=</span> @(x<span class="op">,</span> y<span class="op">,</span> yp) (<span class="op">-</span>yp<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>fyp <span class="op">=</span> @(x<span class="op">,</span> y<span class="op">,</span> yp) (<span class="op">-</span>y<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">3</span><span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> (b <span class="op">-</span> a)<span class="op">/</span>h <span class="op">-</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>alph <span class="op">=</span> <span class="fl">17</span><span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>bet <span class="op">=</span> <span class="fl">43</span><span class="op">/</span><span class="fl">3</span><span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">30</span><span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span> w_grid] <span class="op">=</span> nonlinear_fd_langsung(f<span class="op">,</span> fy<span class="op">,</span> fyp<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet<span class="op">,</span> tol<span class="op">,</span> M)<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">% solusi eksak</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>sln <span class="op">=</span> @(x) ((x <span class="op">.^</span> <span class="fl">2</span>) <span class="op">+</span> ((<span class="fl">16</span> <span class="op">./</span> x)))<span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>y_eksak <span class="op">=</span> sln(x_grid)<span class="op">;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">% menghitung error</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>err_w <span class="op">=</span> <span class="fu">abs</span>(y_eksak <span class="op">-</span> w_grid)<span class="op">;</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>err_total <span class="op">=</span> <span class="fu">sum</span>(err_w)<span class="op">;</span> <span class="co">% norm L1 (taxicab/Manhattan)</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">% tampilkan tabel</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span> long<span class="op">;</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Tabel aproksimasi, solusi y(x), dan error:"</span>)<span class="op">;</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span> w_grid<span class="op">,</span> y_eksak<span class="op">,</span> err_w]</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Error total (norm L1):"</span>)<span class="op">;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(err_total)<span class="op">;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span><span class="op">;</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="fu">hold</span> on<span class="op">;</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="fu">fplot</span>(sln<span class="op">,</span> [a<span class="op">,</span> b]<span class="op">,</span> <span class="st">'k'</span>)<span class="op">;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(x_grid<span class="op">,</span> w_grid<span class="op">,</span> <span class="st">'r'</span>)<span class="op">;</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Aproksimasi y(x)"</span>)<span class="op">;</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"Eksak"</span><span class="op">,</span> <span class="st">"Aproksimasi"</span>)<span class="op">;</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'location'</span><span class="op">,</span> <span class="st">'northeast'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tabel aproksimasi, solusi y(x), dan error:
ans =

 Columns 1 through 3:

   1.000000000000000e+00   1.700000000000000e+01   1.700000000000000e+01
   1.100000000000000e+00   1.575450253529389e+01   1.575545454545455e+01
   1.200000000000000e+00   1.477173965356983e+01   1.477333333333333e+01
   1.300000000000000e+00   1.399567743713438e+01   1.399769230769231e+01
   1.400000000000000e+00   1.338629656205142e+01   1.338857142857143e+01
   1.500000000000000e+00   1.291425241252499e+01   1.291666666666667e+01
   1.600000000000000e+00   1.255753822750665e+01   1.256000000000000e+01
   1.700000000000000e+00   1.229932628240154e+01   1.230176470588235e+01
   1.800000000000000e+00   1.212652886701783e+01   1.212888888888889e+01
   1.900000000000000e+00   1.202881380980783e+01   1.203105263157895e+01
   2.000000000000000e+00   1.199791542246045e+01   1.200000000000000e+01
   2.100000000000000e+00   1.202714237122990e+01   1.202904761904762e+01
   2.200000000000000e+00   1.211101980435058e+01   1.211272727272727e+01
   2.300000000000000e+00   1.224502486731439e+01   1.224652173913043e+01
   2.400000000000000e+00   1.242538836268850e+01   1.242666666666667e+01
   2.500000000000000e+00   1.264894403015380e+01   1.265000000000000e+01
   2.600000000000000e+00   1.291301262278355e+01   1.291384615384615e+01
   2.700000000000000e+00   1.321531175549766e+01   1.321592592592593e+01
   2.800000000000000e+00   1.355388507997838e+01   1.355428571428571e+01
   2.900000000000000e+00   1.392704611844152e+01   1.392724137931035e+01
   3.000000000000000e+00   1.433333333333333e+01   1.433333333333333e+01

 Column 4:

                       0
   9.520101606579345e-04
   1.593679763500333e-03
   2.014870557925263e-03
   2.274866520011187e-03
   2.414254141680061e-03
   2.461772493353109e-03
   2.438423480807472e-03
   2.360021871062656e-03
   2.238821771113564e-03
   2.084577539545052e-03
   1.905247817717282e-03
   1.707468376690002e-03
   1.496871816048184e-03
   1.278303978164530e-03
   1.055969846202487e-03
   8.335310626090831e-04
   6.141704282711657e-04
   4.006343073346130e-04
   1.952608688231550e-04
   1.776356839400250e-15

Error total (norm L1):
3.032075680151891e-02</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-5-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-tiga-dimensi-dan-grid" class="level2">
<h2 class="anchored" data-anchor-id="plot-tiga-dimensi-dan-grid">Plot tiga dimensi dan <em>grid</em></h2>
<p>Misalnya kita ingin membuat plot fungsi <span class="math inline">\(u(x,y) = 4x + y\)</span>, setidaknya di titik-titik <span class="math inline">\(x = 0,1,2,3\)</span> dan <span class="math inline">\(y = 0, 1, 2\)</span>. (Materi ini bisa dianggap perumuman dari materi <em>plotting</em> dua dimensi di <a href="../../../../../semuahalaman/modulprak/2024/genap/pdnum/modul2.html">Modul 2</a>; kalau lupa, mungkin bisa baca itu dulu.)</p>
<p>Pertama-tama, kita bisa membuat <em>array</em> untuk nilai-nilai <span class="math inline">\(x\)</span> dan untuk nilai-nilai <span class="math inline">\(y\)</span> yang kita ingin gunakan untuk <em>plotting</em></p>
<div id="cell-35" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x_arr <span class="op">=</span> [<span class="fl">0</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="fl">3</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y_arr <span class="op">=</span> [<span class="fl">0</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span> <span class="fl">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x_arr =

   0   1   2   3

y_arr =

   0   1   2
</code></pre>
</div>
</div>
<p>Apabila fungsi <span class="math inline">\(u(x,y) = 4x + y\)</span> dihitung di semua titik tersebut, bentuknya akan berupa <em>grid</em>, agar semua kemungkinan nilai <span class="math inline">\(x\)</span> dicoba dengan semua kemungkinan nilai <span class="math inline">\(y\)</span>.</p>
<p>Caranya, kita susun terlebih dahulu dua <em>grid</em>, yaitu satu <em>grid</em> untuk nilai <span class="math inline">\(x\)</span> yang berisi nilai <span class="math inline">\(x\)</span> di posisi yang sesuai, dan satu <em>grid</em> untuk nilai <span class="math inline">\(y\)</span> yang berisi nilai <span class="math inline">\(y\)</span> di posisi yang sesuai. Ada fungsi Octave untuk melakukan ini, yaitu <code>meshgrid</code> yang bisa digunakan sebagai berikut.</p>
<div id="cell-38" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span> y_grid] <span class="op">=</span> <span class="fu">meshgrid</span>(x_arr<span class="op">,</span> y_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x_grid =

   0   1   2   3
   0   1   2   3
   0   1   2   3

y_grid =

   0   0   0   0
   1   1   1   1
   2   2   2   2
</code></pre>
</div>
</div>
<p>Perhatikan,</p>
<ul>
<li><p>untuk posisi pertama <span class="math inline">\(x\)</span>, yaitu dengan <span class="math inline">\(x=0\)</span>, satu kolom itu semuanya diisi <span class="math inline">\(x=0\)</span>. Untuk posisi kedua, satu kolom itu semuanya diisi <span class="math inline">\(x=1\)</span>. Begitu juga untuk <span class="math inline">\(x=2\)</span> dan <span class="math inline">\(x=3\)</span>. Arahnya dari kiri ke kanan.</p></li>
<li><p>untuk <em>grid</em> <span class="math inline">\(y\)</span>, mirip dengan <em>grid</em> <span class="math inline">\(x\)</span>, tetapi arahnya dari atas ke bawah (bukan bawah ke atas).</p></li>
</ul>
<p>Setelah itu, barulah kita buat <em>grid</em> untuk hasilnya yaitu <em>grid</em> untuk <span class="math inline">\(u\)</span>, dengan menerapkan fungsi <span class="math inline">\(u\)</span> menggunakan <em>grid</em> <span class="math inline">\(x\)</span> dan <em>grid</em> <span class="math inline">\(y\)</span> tersebut.</p>
<div id="cell-41" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">% contoh fungsi yang ingin kita coba</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> @(x<span class="op">,</span> y) (<span class="fl">4</span> <span class="op">*</span> x <span class="op">+</span> y)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-42" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">% menggunakan fungsinya untuk memperoleh grid u dari grid x dan grid y</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>u_grid <span class="op">=</span> u(x_grid<span class="op">,</span> y_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>u_grid =

    0    4    8   12
    1    5    9   13
    2    6   10   14
</code></pre>
</div>
</div>
<p>Terakhir, kita tinggal menggambarnya menggunakan fungsi <code>mesh</code> seperti berikut:</p>
<div id="cell-44" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> y_arr<span class="op">,</span> u_grid)<span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Plot u(x,y)=4x+y"</span>)<span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"y"</span>)<span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Perhatikan,</p>
<ul>
<li><p>walaupun tadi arah di <em>grid</em> <span class="math inline">\(y\)</span> adalah dari atas ke bawah, gambarnya masih dari bawah ke atas seperti biasanya (perhatikan sumbunya).</p></li>
<li><p>walaupun tadi kita libatkan <code>x_grid</code> dan <code>y_grid</code> dalam perhitungan untuk memperoleh <code>u_grid</code>, pada akhirnya, yang digunakan untuk <em>plot</em> adalah <code>x_arr</code> dan <code>y_arr</code></p></li>
</ul>
<p>Ketika nilai-nilai <code>u_grid</code> ditampilkan, ia ditampilkan sebagai matriks (nilai <span class="math inline">\(y\)</span> dari atas ke bawah), sehingga mungkin arahnya kurang sesuai dengan gambar (nilai <span class="math inline">\(y\)</span> dari bawah ke atas), seperti terbalik.</p>
<p>Ada fungsi Octave untuk mem-<em>flip</em> atau membalik arah atas-bawah ini, yaitu <code>flipud</code> (<em>flip up-down</em>)</p>
<div id="cell-47" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">flipud</span>(u_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans =

    2    6   10   14
    1    5    9   13
    0    4    8   12
</code></pre>
</div>
</div>
<p>Ketika ditampilkan seperti ini, nilai-nilai <code>u_grid</code> terlihat cocok dengan gambar.</p>
<p>Namun, misalkan kita memerlukan nilai <span class="math inline">\(u(2, 1)\)</span>. Bagaimana cara membacanya dari <em>grid</em>?</p>
<p><span class="math inline">\(x=2\)</span> ada di indeks 3 di <code>x_arr</code></p>
<div id="cell-51" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span>(x_arr <span class="op">==</span> <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans = 3</code></pre>
</div>
</div>
<p><span class="math inline">\(y = 1\)</span> ada di indeks 2 di <code>y_arr</code></p>
<div id="cell-53" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span>(y_arr <span class="op">==</span> <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans = 2</code></pre>
</div>
</div>
<p>Sehingga nilai <span class="math inline">\(u(2,1)\)</span> seharusnya ada di indeks (3,2) dari <code>u_grid</code>…</p>
<div id="cell-55" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>u_grid(<span class="fl">3</span><span class="op">,</span> <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans = 6</code></pre>
</div>
</div>
<p>Hmm, kok aneh? Harusnya kan <span class="math inline">\(u(2,1) = 4(2)+1 = 9\)</span>?</p>
<p>Karena satu dan lain hal, kita perlu mentranspos matriks <em>grid</em> nya terlebih dahulu:</p>
<div id="cell-58" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>u_grid<span class="op">'</span>(<span class="fl">3</span><span class="op">,</span> <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans = 9</code></pre>
</div>
</div>
<p>Selama berurusan dengan PDP secara numerik, seringkali akan seperti itu; matriks untuk menyimpan/mengakses hasil perhitungan adalah transpos dari matriks yang diberikan ke fungsi <code>mesh</code>.</p>
<p>Kali ini, matriks <code>u_grid</code> menyimpan nilai-nilai untuk <code>mesh</code>, sehingga perlu ditranspos untuk keperluan mengakses hasil perhitungan. Nanti bisa juga sebaliknya, yaitu dimiliki matriks yang menyimpan hasil perhitungan, sehingga perlu ditranspos ketika ingin menggunakan <code>mesh</code>.</p>
<p>(Terlebih lagi, orientasi matriks untuk menampilkan nilai-nilai di <em>grid</em> dengan <code>flipud</code> akan sama dengan orientasi matriks untuk fungsi <code>mesh</code>. Jadi, kalau nantinya perlu ditranspos ketika ingin menggunakan <code>mesh</code>, kita juga perlu mentranspos ketika ingin menggunakan <code>flipud</code> untuk menampilkan nilai-nilai di <em>grid</em>.)</p>
<p>Mengapa harus berurusan dengan transpos? Mari kita lihat lagi bentuk matriks <code>u_grid</code></p>
<div id="cell-61" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>u_grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>u_grid =

    0    4    8   12
    1    5    9   13
    2    6   10   14
</code></pre>
</div>
</div>
<p>Nilai 9 ada di mana? Harusnya di indeks (3,2). Kalau kita bayangkan itu adalah <em>grid</em> yang terbalik secara atas-bawah. Berarti, dari ujung kiri-atas yaitu indeks (1,1), kita ke kanan dua langkah, lalu ke bawah satu langkah.</p>
<p>Perhatikan: ke kanan dua langkah adalah <strong>perpindahan kolom</strong>, dan ke bawah satu langkah adalah <strong>perpinahan baris</strong>. Sedangkan, urutan indeks dalam mengakses nilai pada matriks aalah baris dulu, baru kolom. Karena dimensinya terbalik seperti itu, kita perlu mentranspos sebelum mengakses nilainya.</p>
<p>Kalau kita transpos dulu,</p>
<div id="cell-64" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>u_grid<span class="op">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans =

    0    1    2
    4    5    6
    8    9   10
   12   13   14
</code></pre>
</div>
</div>
<p>barulah kita bisa menggunakan indeks (3,2), yaitu di baris ke-3, kolom ke-2.</p>
<div id="cell-66" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>u_grid<span class="op">'</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans = 9</code></pre>
</div>
</div>
<p>Sedikit tambahan: alternatif dari fungsi <code>mesh</code> adalah fungsi <code>surf</code></p>
<div id="cell-68" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">surf</span>(x_arr<span class="op">,</span> y_arr<span class="op">,</span> u_grid)<span class="op">;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Plot u(x,y)=4x+y"</span>)<span class="op">;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"y"</span>)<span class="op">;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Bedanya, fungsi <code>surf</code> memberi warna seperti itu. Walaupun terlihat bagus, mungkin <em>plot</em>nya malah menjadi lebih sulit dibaca, sehingga kita akan tetap menggunakan <code>mesh</code></p>
</section>
<section id="pdp-eliptiklaplacepoisson" class="level2">
<h2 class="anchored" data-anchor-id="pdp-eliptiklaplacepoisson">PDP Eliptik/Laplace/Poisson</h2>
<section id="bentuk-umum-persamaan-laplace" class="level3">
<h3 class="anchored" data-anchor-id="bentuk-umum-persamaan-laplace">Bentuk umum persamaan Laplace</h3>
<p>Di mata kuliah Persamaan Diferensial Numerik, PDP orde 2 eliptik yang dibahas adalah persamaan Laplace, atau juga disebut persamaan Poisson.</p>
<p>Bentuk umum dari persamaan Laplace bisa ditulis <span class="math display">\[\frac{\partial^2 u}{\partial x^2}\left(x,y\right) + \frac{\partial^2 u}{\partial y^2}\left(x,y\right) = f\left(x,y\right), \quad a &lt; x &lt; b, \quad c &lt; y &lt; d\]</span> <span class="math display">\[u\left(x, c\right) = g\left(x, c\right), \quad u\left(x, d\right) = g\left(x, d\right), \quad a \le x \le b\]</span> <span class="math display">\[u\left(a, y\right) = g\left(a, y\right), \quad u\left(b, y\right) = g\left(b, y\right), \quad c \le y \le d\]</span> yang disertai nilai <em>step size</em> <span class="math inline">\(h\)</span> (yaitu <span class="math inline">\(\Delta x\)</span>) dan nilai <em>step size</em> <span class="math inline">\(k\)</span> (yaitu <span class="math inline">\(\Delta y\)</span>).</p>
<p>Perhatikan bahwa ada <em>source function</em> <span class="math inline">\(f\left(x,y\right)\)</span> (yang bisa saja bernilai nol) dan ada syarat batas semua sisi (karena PDP ini dalam variabel <span class="math inline">\(x,y\)</span>).</p>
<p>Selain itu, semua syarat batas seolah-olah diberikan oleh satu fungsi <span class="math inline">\(g\)</span>. Namun, biasanya, syarat batas bawah, atas, kiri, dan kanan yang diketahui tampak seperti fungsi yang berbeda-beda (walaupun sebenarnya digunakan satu fungsi yang sama).</p>
<p>Oleh karena itu, untuk kebutuhan praktikum, kita bisa menuliskan bentuk umum persamaan Laplace sebagai berikut:</p>
<p><span class="math display">\[\frac{\partial^2 u}{\partial x^2}\left(x,y\right) + \frac{\partial^2 u}{\partial y^2}\left(x,y\right) = f\left(x,y\right), \quad a &lt; x &lt; b, \quad c &lt; y &lt; d\]</span> <span class="math display">\[u\left(x, c\right) = \text{db}\left(x, c\right), \quad u\left(x, d\right) = \text{ub}\left(x, d\right), \quad a \le x \le b\]</span> <span class="math display">\[u\left(a, y\right) = \text{lb}\left(a, y\right), \quad u\left(b, y\right) = \text{rb}\left(b, y\right), \quad c \le y \le d\]</span></p>
<p>Keterangan:</p>
<ul>
<li><p><code>db</code> bisa diingat <em>down boundary condition</em>, maksudnya syarat batas bawah</p></li>
<li><p><code>ub</code> bisa diingat <em>upper boundary condition</em>, maksudnya syarat batas atas</p></li>
<li><p><code>lb</code> bisa diingat <em>left boundary condition</em>, maksudnya syarat batas kiri</p></li>
<li><p><code>rb</code> bisa diingat <em>right boundary condition</em>, maksudnya syarat batas kanan</p></li>
</ul>
<p>Kita memberi nama yang berbeda-beda untuk fungsi-fungsi syarat batas ini agar lebih mudah nantinya ketika ingin menginput syarat batas.</p>
<p>Lebih lanjut, batasan interval bisa kita tulis</p>
<p><span class="math display">\[\text{xb} &lt; x &lt; \text{xu}, \quad \text{yb} &lt; y &lt; \text{yu}\]</span></p>
<ul>
<li><p><code>xb</code> bisa diingat “<span class="math inline">\(x\)</span> (below)”</p></li>
<li><p><code>xu</code> bisa diingat “<span class="math inline">\(x\)</span> (upper)”</p></li>
<li><p><code>yb</code> bisa diingat “<span class="math inline">\(y\)</span> (below)”</p></li>
<li><p><code>yu</code> bisa diingat “<span class="math inline">\(y\)</span> (upper)”</p></li>
</ul>
</section>
<section id="ide-utama" class="level3">
<h3 class="anchored" data-anchor-id="ide-utama">Ide utama</h3>
<p>Metode yang umum digunakan dalam penyelesaian PDP secara numerik adalah metode <em>finite difference</em>, melibatkan yang namanaya <strong>diskretisasi</strong>, yaitu memecah tiap interval menjadi titik-titik.</p>
<p>Untuk PDP dalam variabel <span class="math inline">\(x\)</span> dan <span class="math inline">\(y\)</span>, diskretisasi dilakukan sebagai berikut:</p>
<ul>
<li><p>interval <span class="math inline">\(a \le x \le b\)</span> dipecah menjadi titik-titik <span class="math inline">\(x_i = a + ih\)</span> dengan <span class="math inline">\(i=0,\dots,m\)</span>, yaitu menjadi sebanyak <span class="math inline">\((m+1)\)</span> titik</p></li>
<li><p>interval <span class="math inline">\(c \le y \le d\)</span> dipecah menjadi titik-titik <span class="math inline">\(y_j = c + jk\)</span> dengan <span class="math inline">\(j=0,\dots,N\)</span>, yaitu menjadi sebanyak <span class="math inline">\((N+1)\)</span> titik</p></li>
</ul>
<p>Kemudian, hasil aproksimasi solusi PDP pada titik <span class="math inline">\(\left(x_i, y_j\right)\)</span> ditulis <span class="math inline">\(w_{i,j}\)</span></p>
<p>(atau terkadang ditulis <span class="math inline">\(u_i^j\)</span>, atau bahkan <span class="math inline">\(u_j^n\)</span> untuk titik <span class="math inline">\(\left(x_j, y_n\right)\)</span>)</p>
<p>Diskretisasi untuk penylesaian PDP secara numerik bisa dipandang sebagai perumuman dari proses diskretisasi untuk penyelesaian PDB secara numerik, yaitu perumuman dari <span class="math inline">\(t_i = a + ih\)</span> atau terkadang ditulis <span class="math inline">\(x_i = a + ih\)</span>.</p>
<p>Untuk persamaan Laplace, hanya ada satu metode <em>finite difference</em>, yang diawali dengan permisalan nilai lambda berikut:</p>
<p><span class="math display">\[\lambda = \left(\frac{h^2}{k^2}\right) = \frac{h^2}{k^2}\]</span></p>
<p>Ide utama dari metode <em>finite difference</em> untuk persamaan Laplace adalah menuliskan rumus <em>finite difference</em> berikut untuk tiap <span class="math inline">\(i=1,\dots,(m-1)\)</span> dan juga untuk tiap <span class="math inline">\(j=1,\dots,(N-1)\)</span>:</p>
<p><span class="math display">\[2\left(\lambda+1\right) w_{i,j} - \left(w_{i+1,j} + w_{i-1,j}\right) - \lambda\left(w_{i,j+1} + w_{i,j-1}\right) = -h^2 f\left(x_i, y_j\right)\]</span></p>
<p>Setelah menuliskan rumus tersebut sebanyak <span class="math inline">\((m-1)\times(N-1)\)</span> kali, perhatikan bahwa ada beberapa nilai syarat batas yang sudah diketahui dan berupa konstana, misalnya batas bawah <span class="math inline">\(w_{0,0}, w_{1,0}, w_{2,0}, \dots\)</span> dan batas kiri <span class="math inline">\(w_{0,0}, w_{0,1}, w_{0,2}, \dots\)</span></p>
<p>Nilai-nilai yang sudah diketahui tersebut bisa langsung dimasukkan ke dalam persamaan-persamaannya.</p>
<p>Dengan demikian, diperoleh SPL yang terdiri dari <span class="math inline">\((m-1)\times(N-1)\)</span> buah variabel, yaitu variabel-variabel <span class="math inline">\(w_{i,j}\)</span> untuk tiap <span class="math inline">\(i=1,\dots,(m-1)\)</span> dan tiap <span class="math inline">\(j=1,\dots,(N-1)\)</span>.</p>
<p>SPL ini dapat diselesaikan untuk memperoleh semua nilai <span class="math inline">\(w_{i,j}\)</span> sekaligus.</p>
<p>(Dalam penggunaan Octave, indeks <span class="math inline">\(0,\dots,m\)</span> dan <span class="math inline">\(0,\dots,N\)</span> digeser menjadi <span class="math inline">\(1,\dots,(m+1)\)</span> dan <span class="math inline">\(1,\dots,(N+1)\)</span> karena indeks <em>array</em> yang dimulai dari 1.)</p>
</section>
<section id="penggunaan-metode-gauss-seidel" class="level3">
<h3 class="anchored" data-anchor-id="penggunaan-metode-gauss-seidel">Penggunaan metode Gauss-Seidel</h3>
<p>Sayangnya, tidak ada cara cepat untuk menyusun SPL tersebut. Apabila penyelesaian dilakukan secara manual, tidak masalah; kita tinggal susun SPLnya secara manual, hingga bisa disusun dalam bentuk matriks, baru menyelesaikan SPL dalam bentuk matriks tersebut (yang bisa dilakukan dengan metode langsung seperti OBE, invers, ataupun metode iteratif, atau dengan bantuan komputer).</p>
<p>Apabila PDP eliptik ingin diselesaikan secara program, daripada harus menyusun bentuk SPL secara rapi terlebih dahulu, kita bisa menggunakan metode penyelesaian SPL yang iteratif. Contohnya, metode Gauss-Seidel bisa langsung menggunakan bentuk umumnya, yaitu</p>
<p><span class="math display">\[2\left(\lambda+1\right) w_{i,j} - \left(w_{i+1,j} + w_{i-1,j}\right) - \lambda\left(w_{i,j+1} + w_{i,j-1}\right) = -h^2 f\left(x_i, y_j\right)\]</span></p>
<p>yang dipindahruaskan agar diperoleh</p>
<p><span class="math display">\[2\left(\lambda+1\right) w_{i,j} = \left(w_{i+1,j} + w_{i-1,j}\right) + \lambda\left(w_{i,j+1} + w_{i,j-1}\right) -h^2 f\left(x_i, y_j\right)\]</span></p>
<p><span class="math display">\[w_{i,j} = \frac{1}{2\left(\lambda+1\right)}\left(w_{i+1,j} + w_{i-1,j} + \lambda\left(w_{i,j+1} + w_{i,j-1}\right) -h^2 f\left(x_i, y_j\right)\right)\]</span></p>
<p>Mengingat dari mata kuliah Metode Numerik, metode Gauss-Seidel memang memanfaatkan bentuk persamaan yang seperti ini.</p>
<p>Menggunakan metode Gauss-Seidel, kita tinggal memasang tebakan awal untuk tiap variabel <span class="math inline">\(w_{i,j}\)</span> (yang bisa dipasang nol semua menurut buku Burden), kemudian mengulang-ulang perhitungan menggunakan rumus tersebut hingga konvergen.</p>
</section>
<section id="function-file" class="level3">
<h3 class="anchored" data-anchor-id="function-file"><em>Function file</em></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><em>Function file</em> <code>eliptik_iteratif.m</code> - nama <em>file</em> harus sama dengan nama fungsi</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div id="cell-88" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x<span class="op">,</span> y<span class="op">,</span> w] <span class="op">=</span> eliptik_iteratif(f<span class="op">,</span> db<span class="op">,</span> ub<span class="op">,</span> lb<span class="op">,</span> rb<span class="op">,</span> xb<span class="op">,</span> xu<span class="op">,</span> yb<span class="op">,</span> yu<span class="op">,</span> h<span class="op">,</span> k<span class="op">,</span> tol<span class="op">,</span> M)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> xb <span class="op">:</span> h <span class="op">:</span> xu<span class="op">;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> yb <span class="op">:</span> k <span class="op">:</span> yu<span class="op">;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  m_plus_1 <span class="op">=</span> <span class="fu">length</span>(x)<span class="op">;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  N_plus_1 <span class="op">=</span> <span class="fu">length</span>(y)<span class="op">;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">% susun matriks solusi w_{i,j}</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">% awalnya berisi nol semua agar sekaligus mengisi tebakan awal</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> <span class="fu">zeros</span>(m_plus_1<span class="op">,</span> N_plus_1)<span class="op">;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">% isi syarat batas (saat ini masih nol semua)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> m_plus_1 <span class="co">% digeser dari i=0,...,m jadi i=1,...,(m+1)</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span><span class="op">,</span> <span class="fl">1</span>)         <span class="op">=</span> db(x(<span class="fu">i</span>)<span class="op">,</span> yb)<span class="op">;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span><span class="op">,</span> N_plus_1)  <span class="op">=</span> ub(x(<span class="fu">i</span>)<span class="op">,</span> yu)<span class="op">;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> (N_plus_1 <span class="op">-</span> <span class="fl">1</span>) <span class="co">% digeser dari j=1,...,(N-1) jadi j=2,...,N</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    w(<span class="fl">1</span><span class="op">,</span> <span class="fu">j</span>)         <span class="op">=</span> lb(xb<span class="op">,</span> y(<span class="fu">j</span>))<span class="op">;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    w(m_plus_1<span class="op">,</span> <span class="fu">j</span>)  <span class="op">=</span> rb(xu<span class="op">,</span> y(<span class="fu">j</span>))<span class="op">;</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">% lakukan iterasi metode Gauss-Seidel untuk semua nilai w_{i,j} lainnya</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  lambd <span class="op">=</span> (h<span class="op">/</span>k)<span class="op">^</span><span class="fl">2</span><span class="op">;</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  err <span class="op">=</span> tol <span class="op">+</span> <span class="fl">1</span><span class="op">;</span> <span class="co">% errornya sembarang dulu, yang penting masuk loop</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  k <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="op">!</span>(err <span class="op">&lt;=</span> tol) <span class="op">&amp;&amp;</span> (k <span class="op">!=</span> M<span class="op">+</span><span class="fl">1</span>))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    old_values <span class="op">=</span> w(<span class="fl">2</span> <span class="op">:</span> m_plus_1 <span class="op">-</span> <span class="fl">1</span><span class="op">,</span>  <span class="fl">2</span> <span class="op">:</span> N_plus_1 <span class="op">-</span> <span class="fl">1</span>)<span class="op">;</span> <span class="co">% selain syarat batas</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> (m_plus_1 <span class="op">-</span> <span class="fl">1</span>) <span class="co">% digeser dari i=1,...,(m-1) jadi i=2,...,m</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> (N_plus_1 <span class="op">-</span> <span class="fl">1</span>) <span class="co">% digeser dari j=1,...,(N-1) jadi j=2,...,N</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        w(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">+</span> w(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">+</span> lambd <span class="op">*</span> (w(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span><span class="op">+</span><span class="fl">1</span>) <span class="op">+</span> w(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span><span class="op">-</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        w(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">+=</span> <span class="op">-</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> f(x(<span class="fu">i</span>)<span class="op">,</span> y(<span class="fu">j</span>))<span class="op">;</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        w(<span class="fu">i</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">/=</span> <span class="fl">2</span> <span class="op">*</span> (lambd <span class="op">+</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">endfor</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    new_values <span class="op">=</span> w(<span class="fl">2</span> <span class="op">:</span> m_plus_1 <span class="op">-</span> <span class="fl">1</span><span class="op">,</span>  <span class="fl">2</span> <span class="op">:</span> N_plus_1 <span class="op">-</span> <span class="fl">1</span>)<span class="op">;</span> <span class="co">% selain syarat batas</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    err <span class="op">=</span> <span class="fu">max</span>(<span class="fu">max</span>(<span class="fu">abs</span>(old_values <span class="op">-</span> new_values)))<span class="op">;</span> <span class="co">% norm infinity</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    k <span class="op">+=</span> <span class="fl">1</span><span class="op">;</span> <span class="co">% lanjut ke iterasi selanjutnya</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endwhile</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="contoh-1-1" class="level3">
<h3 class="anchored" data-anchor-id="contoh-1-1">Contoh 1</h3>
<p>Selesaikan PDP eliptik</p>
<p><span class="math display">\[\frac{\partial^2 u}{\partial x^2} \left(x,y\right) + \frac{\partial^2 u}{\partial y^2} \left(x,y\right) = 0, \quad 0 &lt; x &lt; 0.5, \quad 0 &lt; y &lt; 0.5\]</span></p>
<p>dengan syarat batas</p>
<p><span class="math display">\[u(x,0) = 0, \quad u(x, 0.5) = 200x, \quad 0 \le x \le 0.5\]</span></p>
<p><span class="math display">\[u(0,y) = 0, \quad u(0.5, y) = 200y, \quad 0 \le y \le 0.5\]</span></p>
<p>secara numerik dengan <em>step size</em> <span class="math inline">\(h = k = 0.125\)</span>, toleransi <span class="math inline">\(10^{-8}\)</span>, dan maksimum iterasi <span class="math inline">\(M=50\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><em>Script file</em> <code>coba1_eliptik.m</code> - nama <em>file</em> bebas</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div id="cell-93" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> @(x<span class="op">,</span>y) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> @(x<span class="op">,</span>y) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> @(x<span class="op">,</span>y) <span class="fl">200</span><span class="op">*</span>x<span class="op">;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> @(x<span class="op">,</span>y) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>rb <span class="op">=</span> @(x<span class="op">,</span>y) <span class="fl">200</span><span class="op">*</span>y<span class="op">;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>xb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>xu <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>yb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>yu <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">0.125</span><span class="op">;</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="fl">0.125</span><span class="op">;</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">50</span><span class="op">;</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>[x_arr<span class="op">,</span> y_arr<span class="op">,</span> w] <span class="op">=</span> eliptik_iteratif(f<span class="op">,</span> db<span class="op">,</span> ub<span class="op">,</span> lb<span class="op">,</span> rb<span class="op">,</span> xb<span class="op">,</span> xu<span class="op">,</span> yb<span class="op">,</span> yu<span class="op">,</span> h<span class="op">,</span> k<span class="op">,</span> tol<span class="op">,</span> M)<span class="op">;</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">% menampilkan nilai aproksimasi dalam bentuk seperi grid</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid nilai aproksimasi:"</span>)<span class="op">;</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(w<span class="op">'</span>))<span class="op">;</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">% gambar mesh hasil aproksimasi</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">figure</span><span class="op">;</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> y_arr<span class="op">,</span> w<span class="op">'</span>)<span class="op">;</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Hasil aproksimasi"</span>)<span class="op">;</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"y"</span>)<span class="op">;</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grid nilai aproksimasi:
          0    25.0000    50.0000    75.0000   100.0000
          0    18.7500    37.5000    56.2500    75.0000
          0    12.5000    25.0000    37.5000    50.0000
          0     6.2500    12.5000    18.7500    25.0000
          0          0          0          0          0</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-21-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="contoh-2-1" class="level3">
<h3 class="anchored" data-anchor-id="contoh-2-1">Contoh 2</h3>
<p>Selesaikan PDP eliptik</p>
<p><span class="math display">\[\frac{\partial^2 u}{\partial x^2} \left(x,y\right) + \frac{\partial^2 u}{\partial y^2} \left(x,y\right) = xe^y, \quad 0 &lt; x &lt; 2, \quad 0 &lt; y &lt; 1\]</span></p>
<p>dengan syarat batas</p>
<p><span class="math display">\[u(x, 0) = x, \quad u(x, 1) = ex, \quad 0 \le x \le 2\]</span></p>
<p><span class="math display">\[u(0, y) = 0, \quad u(2, y) = 2e^y, \quad 0 \le y \le 1\]</span></p>
<p>secara numerik dengan <span class="math inline">\(m = 6\)</span> dan <span class="math inline">\(N = 5\)</span>, menggunakan metode Gauss-Seidel dengan toleransi <span class="math inline">\(10^{-10}\)</span> dan maksimum iterasi <span class="math inline">\(M=100\)</span>.</p>
<p>Lalu, bandingkan hasilnya dengan solusi eksak <span class="math inline">\(u(x,y) = xe^y\)</span></p>
<p>Hint: perhatikan bahwa ruas kanan di PDP eliptik yang diberikan adalah <span class="math inline">\(f(x,y) = xe^y\)</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><em>Script file</em> <code>coba2_eliptik.m</code> - nama <em>file</em> bebas</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div id="cell-99" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> @(x<span class="op">,</span>y) x <span class="op">.*</span> <span class="fu">exp</span>(y)<span class="op">;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> @(x<span class="op">,</span>y) x<span class="op">;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> @(x<span class="op">,</span>y) <span class="bu">e</span> <span class="op">*</span> x<span class="op">;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> @(x<span class="op">,</span>y) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>rb <span class="op">=</span> @(x<span class="op">,</span>y) <span class="fl">2</span> <span class="op">*</span> <span class="fu">exp</span>(y)<span class="op">;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>xb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>xu <span class="op">=</span> <span class="fl">2</span><span class="op">;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>yb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>yu <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">6</span><span class="op">;</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">5</span><span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> (xu <span class="op">-</span> xb)<span class="op">/</span>m<span class="op">;</span> <span class="co">% rumus step size: h = (b-a)/m untuk interval a &lt; x &lt; b</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> (yu <span class="op">-</span> yb)<span class="op">/</span>N<span class="op">;</span> <span class="co">% rumus step size: k = (d-c)/N untuk interval c &lt; y &lt; d</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">10</span>)<span class="op">;</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">100</span><span class="op">;</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>[x_arr<span class="op">,</span> y_arr<span class="op">,</span> w] <span class="op">=</span> eliptik_iteratif(f<span class="op">,</span> db<span class="op">,</span> ub<span class="op">,</span> lb<span class="op">,</span> rb<span class="op">,</span> xb<span class="op">,</span> xu<span class="op">,</span> yb<span class="op">,</span> yu<span class="op">,</span> h<span class="op">,</span> k<span class="op">,</span> tol<span class="op">,</span> M)<span class="op">;</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co">% solusi eksak</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>sln <span class="op">=</span> @(x<span class="op">,</span> y) x <span class="op">.*</span> <span class="fu">exp</span>(y)<span class="op">;</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span> y_grid] <span class="op">=</span> <span class="fu">meshgrid</span>(x_arr<span class="op">,</span> y_arr)<span class="op">;</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> sln(x_grid<span class="op">,</span> y_grid)<span class="op">;</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co">% menampilkan nilai aproksimasi dalam bentuk seperi grid</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid nilai aproksimasi:"</span>)<span class="op">;</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(w<span class="op">'</span>))<span class="op">;</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co">% menampilkan grid solusi eksak</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid solusi eksak:"</span>)<span class="op">;</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(u))<span class="op">;</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="co">% perhitungan error</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>err_grid <span class="op">=</span> <span class="fu">abs</span>(w<span class="op">'</span> <span class="op">-</span> u)<span class="op">;</span> <span class="co">% absolute error</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>err_total <span class="op">=</span> <span class="fu">sum</span>(<span class="fu">sum</span>(err_grid))<span class="op">;</span> <span class="co">% norm L1 (taxicab/Manhattan)</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid nilai error:"</span>)<span class="op">;</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(err_grid))<span class="op">;</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Error total (norm L1):"</span>)<span class="op">;</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(err_total)<span class="op">;</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="co">% gambar mesh hasil aproksimasi</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="fu">figure</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> y_arr<span class="op">,</span> w<span class="op">'</span>)<span class="op">;</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Hasil aproksimasi"</span>)<span class="op">;</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"y"</span>)<span class="op">;</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="co">% gambar mesh solusi eksak</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="fu">figure</span> <span class="fl">2</span><span class="op">;</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> y_arr<span class="op">,</span> u)<span class="op">;</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Solusi eksak"</span>)<span class="op">;</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"y"</span>)<span class="op">;</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grid nilai aproksimasi:
        0   0.9061   1.8122   2.7183   3.6244   4.5305   5.4366
        0   0.7420   1.4840   2.2260   2.9679   3.7097   4.4511
        0   0.6076   1.2152   1.8227   2.4302   3.0375   3.6442
        0   0.4975   0.9950   1.4924   1.9898   2.4870   2.9836
        0   0.4073   0.8145   1.2218   1.6290   2.0360   2.4428
        0   0.3333   0.6667   1.0000   1.3333   1.6667   2.0000
Grid solusi eksak:
        0   0.9061   1.8122   2.7183   3.6244   4.5305   5.4366
        0   0.7418   1.4837   2.2255   2.9674   3.7092   4.4511
        0   0.6074   1.2147   1.8221   2.4295   3.0369   3.6442
        0   0.4973   0.9945   1.4918   1.9891   2.4864   2.9836
        0   0.4071   0.8143   1.2214   1.6285   2.0357   2.4428
        0   0.3333   0.6667   1.0000   1.3333   1.6667   2.0000
Grid nilai error:
 Columns 1 through 6:

            0            0            0            0            0            0
            0   1.6009e-04   3.1459e-04   4.5177e-04   5.4035e-04   4.8919e-04
            0   2.2315e-04   4.3731e-04   6.2391e-04   7.3483e-04   6.4084e-04
            0   2.0835e-04   4.0778e-04   5.8003e-04   6.7871e-04   5.8389e-04
            0   1.3036e-04   2.5524e-04   3.6345e-04   4.2668e-04   3.7106e-04
            0            0            0            0            0            0

 Column 7:

            0
            0
            0
            0
            0
            0
Error total (norm L1):
8.6216e-03</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-22-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-22-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="pdp-hiperbolik-persamaan-gelombang" class="level2">
<h2 class="anchored" data-anchor-id="pdp-hiperbolik-persamaan-gelombang">PDP Hiperbolik / Persamaan Gelombang</h2>
<section id="bentuk-umum-persamaan-gelombang" class="level3">
<h3 class="anchored" data-anchor-id="bentuk-umum-persamaan-gelombang">Bentuk umum persamaan gelombang</h3>
<p>Di mata kuliah Persamaan Diferensial Numerik, PDP orde 2 hiperbolik yang dibahas adalah persamaan gelombang.</p>
<p>Bentuk umum dari persamaan gelombang bisa ditulis</p>
<p><span class="math display">\[\frac{\partial^2 u}{\partial t^2}\left(x,t\right) - \alpha^2 \frac{\partial^2 u}{\partial  x^2}\left(x,t\right) = 0, \quad 0 &lt; x &lt; l, \quad 0 &lt; t &lt; T\]</span></p>
<p><span class="math display">\[u\left(x,0\right) = f\left(x\right), \quad \frac{\partial u}{\partial t}\left(x,0\right) = g\left(x\right), \quad 0 &lt; x &lt; l\]</span></p>
<p><span class="math display">\[u\left(0,t\right) = u\left(l,t\right) = 0, \quad t &gt; 0\]</span></p>
<p>Perhatikan bahwa ada nilai <span class="math inline">\(\alpha^2\)</span> yang pasti positif, ada nilai awal, kecepatan awal, serta syarat batas kiri dan kanan. (PDP ini dalam variabel <span class="math inline">\(x, t\)</span>.)</p>
<p>Untuk kebutuhan praktikum, kita bisa menuliskan bentuk umum persamaan gelombang seperti berikut:</p>
<p><span class="math display">\[\frac{\partial^2 u}{\partial t^2}\left(x,t\right) - \alpha^2 \frac{\partial^2 u}{\partial  x^2}\left(x,t\right) = 0, \quad \text{xb} &lt; x &lt; \text{xu}, \quad \text{tb} &lt; t &lt; \text{tu}\]</span></p>
<p><span class="math display">\[u\left(x,0\right) = f\left(x\right), \quad \frac{\partial u}{\partial t}\left(x,0\right) = g\left(x\right), \quad \text{xb} &lt; x &lt; \text{xu}\]</span></p>
<p><span class="math display">\[u\left(0,t\right) = \text{lb}\left(t\right), \quad \text{tb} &lt; t \le \text{tu}\]</span></p>
<p><span class="math display">\[u\left(l,t\right) = \text{rb}\left(t\right), \quad \text{tb} &lt; t \le \text{tu}\]</span></p>
</section>
<section id="ide-utama-1" class="level3">
<h3 class="anchored" data-anchor-id="ide-utama-1">Ide utama</h3>
<p>Untuk persamaan gelombang, hanya ada satu metode, dengan nilai lambda sebagai berikut:</p>
<p><span class="math display">\[\lambda = \frac{\alpha k}{h}\]</span></p>
<p>Note: nilai <span class="math inline">\(\alpha\)</span> dipilih yang positif.</p>
<p>Ada dua rumus yang terlibat dalam metode ini, yaitu rumus untuk <span class="math inline">\(j=2\)</span> (setelah nilai awal di <span class="math inline">\(j=1\)</span>) dan rumus untuk <span class="math inline">\(j=3,\dots,N+1\)</span>.</p>
<p>Langkah-langkah metode untuk persamaan gelombang bisa dituliskan sebagai berikut:</p>
<ol type="1">
<li><p>Misalkan</p>
<p><span class="math display">\[\lambda = \frac{\alpha k}{h} \quad \text{yaitu} \quad \lambda^2 = \frac{\alpha^2 k^2}{h^2}\]</span></p>
<p>dengan <span class="math inline">\(\alpha = \sqrt{\alpha^2} &gt; 0\)</span>.</p></li>
<li><p>Siapkan matriks grid <span class="math inline">\(w\)</span> berukuran <span class="math inline">\((m+1) \times (N+1)\)</span> untuk menyimpan <span class="math inline">\(w_{i,j}\)</span>.</p>
<p>Isi semua dengan nol dulu, atau setidaknya, pastikan baris pertama dan baris terakhir terisi nol semua (sesuai syarat batas).</p></li>
<li><p>Isi waktu pertama (<span class="math inline">\(j=1\)</span>) berdasarkan nilai awal, yaitu</p>
<p><span class="math display">\[w_{i,1} = f(x_i)\]</span></p>
<p>atau bisa ditulis</p>
<p><span class="math display">\[\textbf{w}^{(1)} = (f(x_2), f(x_3), \dots, f(x_m))\]</span></p></li>
<li><p>Isi waktu kedua (<span class="math inline">\(j=2\)</span>) dengan rumus berikut untuk <span class="math inline">\(i=2,\dots,m+1\)</span></p>
<p><span class="math display">\[w_{i,2} = \left(1-\lambda^2\right)f\left(x_i\right) + \frac{\lambda^2}{2}f\left(x_{i+1}\right) + \frac{\lambda^2}{2}f\left(x_{i-1}\right) + kg\left(x_i\right)\]</span></p></li>
<li><p>Susun matriks tridiagonal <span class="math inline">\(A\)</span> berukuran <span class="math inline">\((m-1) \times (m-1)\)</span> dengan</p>
<ul>
<li><p>nilai <span class="math inline">\(2\left(1-\lambda^2\right)\)</span> di diagonal</p></li>
<li><p>nilai <span class="math inline">\(\lambda^2\)</span> di sebelah kiri dan kanan diagonal</p></li>
<li><p>nol di semua entri lainnya</p></li>
</ul></li>
<li><p>Isi tiap waktu berikutnya (<span class="math inline">\(j=3,\dots,N+1\)</span>) dengan rumus berikut untuk <span class="math inline">\(i=2,\dots,m\)</span></p>
<p><span class="math display">\[w^{(j)} = Aw^{(j-1)} - w^{(j-2)}\]</span></p></li>
</ol>
</section>
<section id="function-file-1" class="level3">
<h3 class="anchored" data-anchor-id="function-file-1"><em>Function file</em></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><em>Function file</em> <code>hiperbolik_matriks.m</code> - nama <em>file</em> harus sama dengan nama fungsi</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div id="cell-112" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x<span class="op">,</span> t<span class="op">,</span> w] <span class="op">=</span> hiperbolik_matriks(alph2<span class="op">,</span> f<span class="op">,</span> g<span class="op">,</span> lb<span class="op">,</span> rb<span class="op">,</span> xb<span class="op">,</span> xu<span class="op">,</span> tb<span class="op">,</span> tu<span class="op">,</span> h<span class="op">,</span> k)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> xb <span class="op">:</span> h <span class="op">:</span> xu<span class="op">;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  t <span class="op">=</span> tb <span class="op">:</span> k <span class="op">:</span> tu<span class="op">;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  m_plus_1 <span class="op">=</span> <span class="fu">length</span>(x)<span class="op">;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  N_plus_1 <span class="op">=</span> <span class="fu">length</span>(t)<span class="op">;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> <span class="fu">zeros</span>(m_plus_1<span class="op">,</span> N_plus_1)<span class="op">;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">% alph = sqrt(alph2);</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">% lambd = alph * k / h;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">% lambd2 = lambd^2;</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  lambd2 <span class="op">=</span> (alph2 <span class="op">*</span> k<span class="op">^</span><span class="fl">2</span>) <span class="op">/</span> (h<span class="op">^</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">% memasang nilai awal (j=1)</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> m_plus_1</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span><span class="op">,</span> <span class="fl">1</span>) <span class="op">=</span> f(x(<span class="fu">i</span>))<span class="op">;</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">% memasang syarat batas</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> N_plus_1</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    w(<span class="fl">1</span><span class="op">,</span> <span class="fu">j</span>)         <span class="op">=</span> lb(t(<span class="fu">j</span>))<span class="op">;</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    w(m_plus_1<span class="op">,</span> <span class="fu">j</span>)  <span class="op">=</span> rb(t(<span class="fu">j</span>))<span class="op">;</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">% isi nilai di j=2 kecuali syarat batas</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> (m_plus_1 <span class="op">-</span> <span class="fl">1</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">% jumlahkan secara bertahap</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span><span class="op">,</span> <span class="fl">2</span>) <span class="op">=</span> (<span class="fl">1</span> <span class="op">-</span> lambd2) <span class="op">*</span> f((x(<span class="fu">i</span>)))<span class="op">;</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span><span class="op">,</span> <span class="fl">2</span>) <span class="op">+=</span> (lambd2 <span class="op">/</span> <span class="fl">2</span>) <span class="op">*</span> (f(x(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>)) <span class="op">+</span> f(x(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>)))<span class="op">;</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span><span class="op">,</span> <span class="fl">2</span>) <span class="op">+=</span> k <span class="op">*</span> g(x(<span class="fu">i</span>))<span class="op">;</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">% susun matriks A</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  A <span class="op">=</span> <span class="fu">zeros</span>(m_plus_1 <span class="op">-</span> <span class="fl">2</span><span class="op">,</span> m_plus_1 <span class="op">-</span> <span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> (m_plus_1 <span class="op">-</span> <span class="fl">2</span>)</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">% isi sebelah kiri/bawah diagonal</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">i</span> <span class="op">&gt;</span> <span class="fl">1</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>      A(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">=</span> lambd2<span class="op">;</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endif</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">% isi diagonal</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>    A(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span>) <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> (<span class="fl">1</span> <span class="op">-</span> lambd2)<span class="op">;</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">% isi sebelah kanan/atas diagonal</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">i</span> <span class="op">&lt;</span> m_plus_1 <span class="op">-</span> <span class="fl">2</span>)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>      A(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> lambd2<span class="op">;</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endif</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">% isi nilai di sisanya yaitu j=3, ..., N+1</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">3</span> <span class="op">:</span> N_plus_1</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">% pengurangan secara bertahap</span></span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>    w(<span class="fl">2</span> <span class="op">:</span> m_plus_1 <span class="op">-</span> <span class="fl">1</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">=</span> A <span class="op">*</span> w(<span class="fl">2</span> <span class="op">:</span> m_plus_1 <span class="op">-</span> <span class="fl">1</span><span class="op">,</span> <span class="fu">j</span><span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>    w(<span class="fl">2</span> <span class="op">:</span> m_plus_1 <span class="op">-</span> <span class="fl">1</span><span class="op">,</span> <span class="fu">j</span>) <span class="op">-=</span> w(<span class="fl">2</span> <span class="op">:</span> m_plus_1 <span class="op">-</span> <span class="fl">1</span><span class="op">,</span> <span class="fu">j</span><span class="op">-</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="contoh-1-2" class="level3">
<h3 class="anchored" data-anchor-id="contoh-1-2">Contoh 1</h3>
<p>Selesaikan persamaan gelombang berikut,</p>
<p><span class="math display">\[\frac{\partial^2 u}{\partial t^2} - \frac{\partial^2 u}{\partial x^2} = 0, \quad 0 &lt; x &lt; 1, \quad 0 &lt; t &lt; T,\]</span></p>
<p>dengan nilai awal dan kecepatan awal</p>
<p><span class="math display">\[u(x,0) = \sin{\pi x}, \quad \frac{\partial u}{\partial t}(x,0) = 0, \quad 0 \le x \le 1\]</span></p>
<p>serta syarat batas</p>
<p><span class="math display">\[u(0,t) = u(1,t) = 0, \quad 0 &lt; t,\]</span></p>
<p>dengan <span class="math inline">\(m=4\)</span>, <span class="math inline">\(N=4\)</span>, dan <span class="math inline">\(T=1\)</span>.</p>
<p>Lalu, bandingkan hasilnya dengan solusi eksak</p>
<p><span class="math display">\[u(x,t) = \cos{\left(\pi t\right)} \sin{\left(\pi x\right)}\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><em>Script file</em> <code>coba1_hiperbolik_matriks.m</code> - nama <em>file</em> bebas</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div id="cell-117" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>alph2 <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> @(x) <span class="fu">sin</span>(<span class="bu">pi</span> <span class="op">*</span> x)<span class="op">;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> @(x) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> @(t) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>rb <span class="op">=</span> @(t) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>xb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>xu <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>tb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>tu <span class="op">=</span> <span class="fl">1</span><span class="op">;</span> <span class="co">% T</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">4</span><span class="op">;</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">4</span><span class="op">;</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> (xu <span class="op">-</span> xb)<span class="op">/</span>m<span class="op">;</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> (tu <span class="op">-</span> tb)<span class="op">/</span>N<span class="op">;</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>[x_arr<span class="op">,</span> t_arr<span class="op">,</span> w] <span class="op">=</span> hiperbolik_matriks(alph2<span class="op">,</span> f<span class="op">,</span> g<span class="op">,</span> lb<span class="op">,</span> rb<span class="op">,</span> xb<span class="op">,</span> xu<span class="op">,</span> tb<span class="op">,</span> tu<span class="op">,</span> h<span class="op">,</span> k)<span class="op">;</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">% solusi eksak</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>sln <span class="op">=</span> @(x<span class="op">,</span>t) <span class="fu">cos</span>(<span class="bu">pi</span> <span class="op">*</span> t) <span class="op">.*</span> <span class="fu">sin</span>(<span class="bu">pi</span> <span class="op">*</span> x)<span class="op">;</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span> t_grid] <span class="op">=</span> <span class="fu">meshgrid</span>(x_arr<span class="op">,</span> t_arr)<span class="op">;</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> sln(x_grid<span class="op">,</span> t_grid)<span class="op">;</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co">% menampilkan nilai aproksimasi dalam bentuk seperi grid</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid nilai aproksimasi:"</span>)<span class="op">;</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(w<span class="op">'</span>))<span class="op">;</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co">% menampilkan grid solusi eksak</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid solusi eksak:"</span>)<span class="op">;</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(u))<span class="op">;</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="co">% perhitungan error</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>err_grid <span class="op">=</span> <span class="fu">abs</span>(w<span class="op">'</span> <span class="op">-</span> u)<span class="op">;</span> <span class="co">% absolute error</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>err_total <span class="op">=</span> <span class="fu">sum</span>(<span class="fu">sum</span>(err_grid))<span class="op">;</span> <span class="co">% norm L1 (taxicab/Manhattan)</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid nilai error:"</span>)<span class="op">;</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(err_grid))<span class="op">;</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Error total (norm L1):"</span>)<span class="op">;</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(err_total)<span class="op">;</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="co">% gambar mesh hasil aproksimasi</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="fu">figure</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> t_arr<span class="op">,</span> w<span class="op">'</span>)<span class="op">;</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Hasil aproksimasi"</span>)<span class="op">;</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"t"</span>)<span class="op">;</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="co">% gambar mesh solusi eksak</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="fu">figure</span> <span class="fl">2</span><span class="op">;</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> t_arr<span class="op">,</span> u)<span class="op">;</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Solusi eksak"</span>)<span class="op">;</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"t"</span>)<span class="op">;</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grid nilai aproksimasi:
        0  -0.7071  -1.0000  -0.7071        0
        0  -0.5000  -0.7071  -0.5000        0
        0        0        0  -0.0000        0
        0   0.5000   0.7071   0.5000        0
        0   0.7071   1.0000   0.7071   0.0000
Grid solusi eksak:
        0  -0.7071  -1.0000  -0.7071  -0.0000
        0  -0.5000  -0.7071  -0.5000  -0.0000
        0   0.0000   0.0000   0.0000   0.0000
        0   0.5000   0.7071   0.5000   0.0000
        0   0.7071   1.0000   0.7071   0.0000
Grid nilai error:
            0   1.1102e-16            0   1.1102e-16   1.2246e-16
            0   1.1102e-16   1.1102e-16   1.1102e-16   8.6596e-17
            0   4.3298e-17   6.1232e-17   1.5432e-16   7.4988e-33
            0            0   1.1102e-16            0   8.6596e-17
            0            0            0            0            0
Error total (norm L1):
1.2206e-15</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-24-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-24-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="contoh-2-2" class="level3">
<h3 class="anchored" data-anchor-id="contoh-2-2">Contoh 2</h3>
<p>Akan kita uji menggunakan persamaan gelombang:</p>
<p><span class="math display">\[\begin{align*}
    u_{tt} - (0.25)^2 u_{xx} &amp;= 0, \quad 0 &lt; x &lt; 1, \quad 0 &lt; t &lt; 1, \\
    u(0,t) = u(1,t) &amp;= 0, \quad 0 &lt; t \le 1, \\
    u(x,0) &amp;= 0, \quad 0 \le x \le 1 \\
    u_t(x,0) &amp;= x(1-x), \quad 0 \le x \le 1
\end{align*}\]</span></p>
<p>Solusi eksak dari PDP tersebut adalah</p>
<p><span class="math display">\[u(x,t) = \sum_{n=1}^{\infty} c_n \sin{\left(0.25n\pi t\right)} \sin{\left(n\pi x\right)}\]</span></p>
<p><span class="math display">\[c_n = \frac{2}{0.25n\pi} \int_0^1 x(1-x) \sin{\left(n\pi x\right)} dx, \quad n = 1, 2, \dots\]</span></p>
<p>Untuk keperluan komputasi, akan kita ambil 10 suku pertama dari ekspansi deret Fourier dari <span class="math inline">\(u(x,t)\)</span>.</p>
<p>Gunakan <span class="math inline">\(h = \Delta x = 0.125\)</span> dan <span class="math inline">\(k = \Delta t = 0.05\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true"><em>Script file</em> <code>coba2_hiperbolik_matriks.m</code> - nama <em>file</em> bebas</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div id="cell-125" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>alph2 <span class="op">=</span> <span class="fl">0.25</span><span class="op">^</span><span class="fl">2</span><span class="op">;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> @(x) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> @(x) x <span class="op">.*</span> (<span class="fl">1</span><span class="op">-</span>x)<span class="op">;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> @(t) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>rb <span class="op">=</span> @(t) <span class="fl">0</span><span class="op">;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>xb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>xu <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>tb <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>tu <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">0.125</span><span class="op">;</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="fl">0.05</span><span class="op">;</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>[x_arr<span class="op">,</span> t_arr<span class="op">,</span> w] <span class="op">=</span> hiperbolik_matriks(alph2<span class="op">,</span> f<span class="op">,</span> g<span class="op">,</span> lb<span class="op">,</span> rb<span class="op">,</span> xb<span class="op">,</span> xu<span class="op">,</span> tb<span class="op">,</span> tu<span class="op">,</span> h<span class="op">,</span> k)<span class="op">;</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">% solusi eksak dari deret</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="fu">zeros</span>(<span class="fu">length</span>(x)<span class="op">,</span> <span class="fu">length</span>(t))<span class="op">;</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> <span class="fu">length</span>(x)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> <span class="fu">length</span>(t)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">% penjumlahan deret secara bertahap</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    u(<span class="fu">i</span><span class="op">,</span><span class="fu">j</span>) <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> <span class="fl">10</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>      F <span class="op">=</span> @(x) x <span class="op">.*</span> (<span class="fl">1</span><span class="op">-</span>x) <span class="op">.*</span> <span class="fu">sin</span>(n <span class="op">*</span> <span class="bu">pi</span> <span class="op">.*</span> x)<span class="op">;</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>      cn <span class="op">=</span> <span class="fl">2</span><span class="op">/</span>(<span class="fl">0.25</span><span class="op">*</span>n<span class="op">*</span><span class="bu">pi</span>) <span class="op">*</span> integral(F<span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>      u(<span class="fu">i</span><span class="op">,</span><span class="fu">j</span>) <span class="op">+=</span> cn <span class="op">*</span> <span class="fu">sin</span>(<span class="fl">0.25</span> <span class="op">*</span> n <span class="op">*</span> <span class="bu">pi</span> <span class="op">*</span> t(<span class="fu">j</span>)) <span class="op">*</span> <span class="fu">sin</span>(n <span class="op">*</span> <span class="bu">pi</span> <span class="op">*</span> x(<span class="fu">i</span>))<span class="op">;</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="cf">endfor</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co">% menampilkan nilai aproksimasi dalam bentuk seperi grid</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid nilai aproksimasi:"</span>)<span class="op">;</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(w<span class="op">'</span>))<span class="op">;</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co">% menampilkan grid solusi eksak</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid solusi eksak:"</span>)<span class="op">;</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(u<span class="op">'</span>))<span class="op">;</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="co">% perhitungan error</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>err_grid <span class="op">=</span> <span class="fu">abs</span>(w<span class="op">'</span> <span class="op">-</span> u<span class="op">'</span>)<span class="op">;</span> <span class="co">% absolute error</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>err_total <span class="op">=</span> <span class="fu">sum</span>(<span class="fu">sum</span>(err_grid))<span class="op">;</span> <span class="co">% norm L1 (taxicab/Manhattan)</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Grid nilai error:"</span>)<span class="op">;</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="fu">flipud</span>(err_grid))<span class="op">;</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(<span class="st">"Error total (norm L1):"</span>)<span class="op">;</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="fu">disp</span>(err_total)<span class="op">;</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a><span class="co">% gambar mesh hasil aproksimasi</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a><span class="fu">figure</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> t_arr<span class="op">,</span> w<span class="op">'</span>)<span class="op">;</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Hasil aproksimasi"</span>)<span class="op">;</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"t"</span>)<span class="op">;</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a><span class="co">% gambar mesh solusi eksak</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a><span class="fu">figure</span> <span class="fl">2</span><span class="op">;</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a><span class="fu">mesh</span>(x_arr<span class="op">,</span> t_arr<span class="op">,</span> u<span class="op">'</span>)<span class="op">;</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Solusi eksak"</span>)<span class="op">;</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel</span>(<span class="st">"t"</span>)<span class="op">;</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a><span class="fu">zlabel</span>(<span class="st">"u"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grid nilai aproksimasi:
 Columns 1 through 8:

        0   0.0920   0.1670   0.2136   0.2292   0.2136   0.1670   0.0920
        0   0.0888   0.1605   0.2049   0.2197   0.2049   0.1605   0.0888
        0   0.0854   0.1538   0.1958   0.2099   0.1958   0.1538   0.0854
        0   0.0818   0.1467   0.1865   0.1998   0.1865   0.1467   0.0818
        0   0.0781   0.1394   0.1769   0.1894   0.1769   0.1394   0.0781
        0   0.0742   0.1319   0.1670   0.1788   0.1670   0.1319   0.0742
        0   0.0701   0.1242   0.1570   0.1679   0.1570   0.1242   0.0701
        0   0.0658   0.1162   0.1467   0.1568   0.1467   0.1162   0.0658
        0   0.0614   0.1080   0.1362   0.1455   0.1362   0.1080   0.0614
        0   0.0569   0.0997   0.1255   0.1341   0.1255   0.0997   0.0569
        0   0.0522   0.0912   0.1146   0.1224   0.1146   0.0912   0.0522
        0   0.0474   0.0825   0.1036   0.1106   0.1036   0.0825   0.0474
        0   0.0425   0.0737   0.0924   0.0987   0.0924   0.0737   0.0425
        0   0.0374   0.0648   0.0812   0.0866   0.0812   0.0648   0.0374
        0   0.0323   0.0557   0.0698   0.0745   0.0698   0.0557   0.0323
        0   0.0270   0.0466   0.0583   0.0622   0.0583   0.0466   0.0270
        0   0.0217   0.0373   0.0467   0.0498   0.0467   0.0373   0.0217
        0   0.0163   0.0281   0.0351   0.0374   0.0351   0.0281   0.0163
        0   0.0109   0.0187   0.0234   0.0250   0.0234   0.0187   0.0109
        0   0.0055   0.0094   0.0117   0.0125   0.0117   0.0094   0.0055
        0        0        0        0        0        0        0        0

 Column 9:

        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
        0
Grid solusi eksak:
 Columns 1 through 8:

        0   0.0912   0.1666   0.2135   0.2292   0.2135   0.1666   0.0912
        0   0.0880   0.1602   0.2048   0.2197   0.2048   0.1602   0.0880
        0   0.0846   0.1535   0.1957   0.2098   0.1957   0.1535   0.0846
        0   0.0811   0.1466   0.1864   0.1997   0.1864   0.1466   0.0811
        0   0.0774   0.1393   0.1768   0.1893   0.1768   0.1393   0.0774
        0   0.0736   0.1318   0.1670   0.1787   0.1670   0.1318   0.0736
        0   0.0696   0.1241   0.1569   0.1678   0.1569   0.1241   0.0696
        0   0.0654   0.1162   0.1466   0.1568   0.1466   0.1162   0.0654
        0   0.0611   0.1080   0.1361   0.1455   0.1361   0.1080   0.0611
        0   0.0567   0.0997   0.1255   0.1340   0.1255   0.0997   0.0567
        0   0.0520   0.0912   0.1146   0.1224   0.1146   0.0912   0.0520
        0   0.0473   0.0825   0.1036   0.1106   0.1036   0.0825   0.0473
        0   0.0424   0.0737   0.0924   0.0987   0.0924   0.0737   0.0424
        0   0.0374   0.0647   0.0811   0.0866   0.0811   0.0647   0.0374
        0   0.0323   0.0557   0.0697   0.0744   0.0697   0.0557   0.0323
        0   0.0270   0.0465   0.0583   0.0622   0.0583   0.0465   0.0270
        0   0.0217   0.0373   0.0467   0.0498   0.0467   0.0373   0.0217
        0   0.0164   0.0280   0.0351   0.0374   0.0351   0.0280   0.0164
        0   0.0109   0.0187   0.0234   0.0250   0.0234   0.0187   0.0109
        0   0.0055   0.0094   0.0117   0.0125   0.0117   0.0094   0.0055
        0        0        0        0        0        0        0        0

 Column 9:

   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
   0.0000
        0
Grid nilai error:
 Columns 1 through 6:

            0   8.8525e-04   3.8928e-04   7.7316e-05   3.4570e-05   7.7316e-05
            0   8.4394e-04   2.9470e-04   7.1736e-05   3.1040e-05   7.1736e-05
            0   7.8956e-04   2.1644e-04   6.5668e-05   3.0855e-05   6.5668e-05
            0   7.2399e-04   1.5428e-04   5.8621e-05   3.3324e-05   5.8621e-05
            0   6.4968e-04   1.0712e-04   5.0674e-05   3.7425e-05   5.0674e-05
            0   5.6942e-04   7.3213e-05   4.2316e-05   4.1967e-05   4.2316e-05
            0   4.8623e-04   5.0406e-05   3.4249e-05   4.5771e-05   3.4249e-05
            0   4.0312e-04   3.6338e-05   2.7202e-05   4.7839e-05   2.7202e-05
            0   3.2290e-04   2.8672e-05   2.1765e-05   4.7490e-05   2.1765e-05
            0   2.4810e-04   2.5270e-05   1.8270e-05   4.4452e-05   1.8270e-05
            0   1.8076e-04   2.4319e-05   1.6737e-05   3.8881e-05   1.6737e-05
            0   1.2244e-04   2.4401e-05   1.6869e-05   3.1322e-05   1.6869e-05
            0   7.4103e-05   2.4513e-05   1.8111e-05   2.2613e-05   1.8111e-05
            0   3.6165e-05   2.4038e-05   1.9748e-05   1.3747e-05   1.9748e-05
            0   8.5035e-06   2.2681e-05   2.1026e-05   5.7195e-06   2.1026e-05
            0   9.4826e-06   2.0388e-05   2.1273e-05   6.2686e-07   2.1273e-05
            0   1.8808e-05   1.7258e-05   2.0015e-05   4.7246e-06   2.0015e-05
            0   2.0824e-05   1.3468e-05   1.7041e-05   6.3650e-06   1.7041e-05
            0   1.7141e-05   9.2141e-06   1.2436e-05   5.7251e-06   1.2436e-05
            0   9.5601e-06   4.6739e-06   6.5641e-06   3.3363e-06   6.5641e-06
            0            0            0            0            0            0

 Columns 7 through 9:

   3.8928e-04   8.8525e-04   2.9230e-17
   2.9470e-04   8.4394e-04   2.8221e-17
   2.1644e-04   7.8956e-04   2.7166e-17
   1.5428e-04   7.2399e-04   2.6065e-17
   1.0712e-04   6.4968e-04   2.4920e-17
   7.3213e-05   5.6942e-04   2.3732e-17
   5.0406e-05   4.8623e-04   2.2499e-17
   3.6338e-05   4.0312e-04   2.1222e-17
   2.8672e-05   3.2290e-04   1.9896e-17
   2.5270e-05   2.4810e-04   1.8521e-17
   2.4319e-05   1.8076e-04   1.7093e-17
   2.4401e-05   1.2244e-04   1.5611e-17
   2.4513e-05   7.4103e-05   1.4071e-17
   2.4038e-05   3.6165e-05   1.2474e-17
   2.2681e-05   8.5035e-06   1.0821e-17
   2.0388e-05   9.4826e-06   9.1133e-18
   1.7258e-05   1.8808e-05   7.3566e-18
   1.3468e-05   2.0824e-05   5.5575e-18
   9.2141e-06   1.7141e-05   3.7246e-18
   4.6739e-06   9.5601e-06   1.8683e-18
            0            0            0
Error total (norm L1):
0.017764</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-25-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul7_files/figure-html/cell-25-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>