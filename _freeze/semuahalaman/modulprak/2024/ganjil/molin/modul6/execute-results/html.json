{
  "hash": "225a49e359fefcbd1a37f19a5ad530a0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Logistic Regression\"\nsubtitle: \"Pembelajaran regresi logistic\"\nimage: static\\bg_modul6.jpg\ndescription: \"Offline di Departemen Matematika\"\ndate: 11/25/2024\npage-navigation: true\nformat:\n  html:\n    code-overflow: wrap\nknitr:\n  opts_chunk:\n    comment: ''\nformat-links: false\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n# Struktur Pembelajaran\nHalo, selamat sejahtera semua. Kali ini kita akan masuk pembelajaran regresi logistik. Pembelajaran kali ini akan memiliki bertujuan untuk mengetahui secara sederhana  untuk kalian dapat menentukan kapan kalian menggunakan regresi linear sederhana & regresi logistik sederhana.\n\nAkan tetapi, bagi kalian yang ingin memahami secara penuh, kita tetap menyediakan penjelasan pada link halaman lainnya.\n\n## Mempersiapkan code\n### Attach Data\nKita akan mendapatkan koleksi data *real* dari [repositori pembelajaran mesin UCI](http://archive.ics.uci.edu/) khususnya kita akan mengambil data [penyakit jantung](http://archive.ics.uci.edu/ml/datasets/Heart+Disease) \n\n\n\n\n\n\nKita mulai dengan membuat variabel bernama URL dan menyetelnya ke lokasi data yang kita inginkan \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- \"https://raw.githubusercontent.com/StatQuest/logistic_regression_demo/master/processed.cleveland.data\"\n \ndata <- read.csv(url, header=FALSE)\n```\n:::\n\n\nbeginilah cara `R` membaca `collection` data dari URL.\n\nFungsi `head` menunjukkan kepada kita 6 baris data pertama, sayangnya tidak ada kolom yang diberi **label**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(data)\n```\n:::\n\n\n**Oh no!**\n\nData nya tidak rapih. Kalau begitu, sekarang ...\n\n### Pre-Processing Data\n\nKita menamai kolom tersebut dengan nama yang terdaftar di situs web UCI.\n\nMari kita format ulang data nya agar:\n\n1. **Mudah digunakan**\n2. **Ditafsirkan** *( interpreted )* dengan benar oleh `glm()`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(data) <- c(\n  \"age\",\n  \"sex\",# 0 = female, 1 = male\n  \"cp\", # chest pain\n  # 1 = typical angina,\n  # 2 = atypical angina,\n  # 3 = non-anginal pain,\n  # 4 = asymptomatic\n  \"trestbps\", # resting blood pressure (in mm Hg)\n  \"chol\", # serum cholestoral in mg/dl\n  \"fbs\",  # fasting blood sugar if less than 120 mg/dl, 1 = TRUE, 0 = FALSE\n  \"restecg\", # resting electrocardiographic results\n  # 1 = normal\n  # 2 = having ST-T wave abnormality\n  # 3 = showing probable or definite left ventricular hypertrophy\n  \"thalach\", # maximum heart rate achieved\n  \"exang\",   # exercise induced angina, 1 = yes, 0 = no\n  \"oldpeak\", # ST depression induced by exercise relative to rest\n  \"slope\", # the slope of the peak exercise ST segment\n  # 1 = upsloping\n  # 2 = flat\n  # 3 = downsloping\n  \"ca\", # number of major vessels (0-3) colored by fluoroscopy\n  \"thal\", # this is short of thalium heart scan\n  # 3 = normal (no cold spots)\n  # 6 = fixed defect (cold spots during rest and exercise)\n  # 7 = reversible defect (when cold spots only appear during exercise)\n  \"hd\" # (the predicted attribute) - diagnosis of heart disease\n  # 0 if less than or equal to 50% diameter narrowing\n  # 1 if greater than 50% diameter narrowing\n)\n```\n:::\n\n\n\nHoorayy ðŸ¥° sekarang ketika kita melihat 6 baris pertama dengan fungsi `head` segalanya terlihat jauh lebih baikðŸŽ‰\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(data)\n```\n:::\n\n\n\nNamun, fungsi `str` yang menjelaskan struktur data memberi tahu kita bahwa beberapa kolom sedang kacau saat ini.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(data) # this shows that we need to tell R which columns contain factors\n# it also shows us that there are some missing values. There are \"?\"s\n# in the dataset. These are in the \"ca\" and \"thal\" columns...\n```\n:::\n\n\nkekacauannya adalah sebagai berikut:\n\n1. `sex` adalah angka (**number**) tetapi seharusnya menjadi **factor** di mana nol mewakili perempuan dan satu mewakili laki laki \n2. `CP` alias nyeri dada juga seharusnya menjadi **factor** di mana level 1 hingga 3 mewakili berbagai jenis nyeri dan 4 tidak mewakili nyeri dada \n3. `CA` dan `Thal` disebut dengan benar sebagai **faktor** tetapi salah satu levelnya adalah *tanda tanya* saat kita membutuhkannya\n\nJadi kita harus melakukan **pembersihan**\n\n### Cleaning Data\n\nHal pertama yang kita lakukan adalah \n\n- mengubah *tanda tanya* menjadi `NA` \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## First, convert \"?\"s to NAs...\ndata[data == \"?\"] <- NA\n```\n:::\n\n\n\n- lalu hanya untuk mempermudah melihat data kita mengubah angka nol dalam `sex` menjadi F untuk perempuan dan yang menjadi M untuk laki laki \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Now add factors for variables that are factors and clean up the factors\n## that had missing data...\ndata[data$sex == 0,]$sex <- \"F\"\ndata[data$sex == 1,]$sex <- \"M\"\ndata$sex <- as.factor(data$sex)\n```\n:::\n\n\n\n- terakhir kita mengubah kolom yang seharusnya menjadi **factor** karena memang seharusnya demikian lihat situs web UCI\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$cp <- as.factor(data$cp)\ndata$fbs <- as.factor(data$fbs)\ndata$restecg <- as.factor(data$restecg)\ndata$exang <- as.factor(data$exang)\ndata$slope <- as.factor(data$slope)\n```\n:::\n\n\n\nOh no! Coba perhatikan yang lain sekarang.\nKarena kolom `CA` awalnya memiliki *tanda tanya* di dalamnya alih-alih menganggap itu kolom `string`, kita mengoreksi asumsi itu dengan memberi tahu bahwa itu adalah kolom `integer` dan kemudian kita mengubahnya menjadi **factor**, lalu kita melakukan hal yang sama untuk `Thal`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$ca <- as.integer(data$ca) # since this column had \"?\"s in it\n# R thinks that the levels for the factor are strings, but\n# we know they are integers, so first convert the strings to integers...\ndata$ca <- as.factor(data$ca)  # ...then convert the integers to factor levels\n\ndata$thal <- as.integer(data$thal) # \"thal\" also had \"?\"s in it.\ndata$thal <- as.factor(data$thal)\n```\n:::\n\n\n\n- hal lain yang perlu kita lakukan pada data adalah menjadikan `HD` alias penyakit jantung sebagai **factor** yang mudah dilihat.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## This next line replaces 0 and 1 with \"Healthy\" and \"Unhealthy\"\ndata$hd <- ifelse(test=data$hd == 0, yes=\"Healthy\", no=\"Unhealthy\")\ndata$hd <- as.factor(data$hd) # Now convert to a factor\n```\n:::\n\n\n\nDi sini saya menggunakan trik *fancy* dengan fungsi `if-else` untuk mengubah angka nol menjadi sehat dan yang menjadi tidak sehat. \n\nKita bisa saja melakukan trik serupa untuk `sex` tapi saya ingin menunjukkan kepada Anda, kedua cara ini untuk mengubah angka menjadi `string`.\n\nSetelah selesai memperbaiki data, kita periksa bahwa kita telah membuat perubahan yang sesuai kita harapkan dengan fungsi `str` \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(data) ## this shows that the correct columns are factors\n```\n:::\n\n\nhoooraaayy berhasil ðŸŽ‰ðŸŽ‰ðŸŽ‰\n\n\n### Handling Missing Value\n\nSekarang kita melihat berapa banyak baris sampel data yang memiliki nilai `na`. nanti kita akan memutuskan apakah kita bisa membuang sampel ini atau apakah kita harus memasukkan nilai untuk `NA`. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Now determine how many rows have \"NA\" (aka \"Missing data\"). If it's just\n## a few, we can remove them from the dataset, otherwise we should consider\n## imputing the values with a Random Forest or some other imputation method.\nnrow(data[is.na(data$ca) | is.na(data$thal),])\ndata[is.na(data$ca) | is.na(data$thal),]\n## so 6 of the 303 rows of data have missing values. This isn't a large\n## percentage (2%), so we can just remove them from the dataset\nnrow(data)\n```\n:::\n\n\n\n6 baris sampel data memiliki `NA` di dalamnya. \n\nkita dapat melihat sampel di dalamnya dengan memilih baris tersebut dari `dataframe` dan di sanalah mereka di sini adalah nilai `NA` lima dari enam sampel adalah laki-laki dan dua dari enam memiliki penyakit jantung. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata[is.na(data$ca) | is.na(data$thal),]\n```\n:::\n\n\n\njika kita mau, kita dapat mengaitkan nilai untuk `NA` menggunakan `random forest` atau metode lain. namun untuk contoh ini kita hanya akan menghapus sampel ini termasuk enam sampel dalam `NA`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(data)\ndata <- data[!(is.na(data$ca) | is.na(data$thal)),]\nnrow(data)\n```\n:::\n\n\nada tiga ratus tiga sampel kemudian kita menghapus enam sampel yang memiliki `NA`, dan setelah menghapus sampel tersebut ada dua ratus sembilan puluh tujuh sampel yang tersisa.\n\nSekarang kita perlu memastikan bahwa sampel yang sehat dan berpenyakit berasal dari setiap jenis kelamin perempuan dan laki-laki.\n\njika hanya sampel laki-laki yang memiliki penyakit jantung, kita mungkin harus menghapus semua perempuan dari model tersebut. \n\nkita melakukan ini dengan fungsi `xtabs` kita meneruskan `xtabs` data dan menggunakan sintaks model untuk memilih kolom dalam data yang ingin kita buat tabelnya. Dalam hal ini kita menginginkan tabel dengan penyakit jantung dan `sex`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxtabs(~ hd + sex, data=data)\n\n## Most of the females are healthy and most of the males are unhealthy.\n## Being female is likely to decrease the odds in being unhealthy.\n##    In other words, if a sample is female, the odds are against it that it\n##    will be unhealthy\n## Being male is likely to increase the odds in being unhealthy...\n##    In other words, if a sample is male, the odds are for it being unhealthy\n```\n:::\n\n\n\npasien sehat dan tidak sehat sama-sama diwakili oleh banyak sampel wanita dan pria singkatnya dilaporkan oleh sekelompok pasien.\n\n\n\n::: {.cell}\n\n```{.shell .cell-code}\n## Most of the females are healthy and most of the males are unhealthy.\n## Being female is likely to decrease the odds in being unhealthy.\n##    In other words, if a sample is female, the odds are against it that it\n##    will be unhealthy\n## Being male is likely to increase the odds in being unhealthy...\n##    In other words, if a sample is male, the odds are for it being unhealthy\n```\n:::\n\n\n\nsekarang mari kita verifikasi bahwa keempat tingkat nyeri dada `CP`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Now we can do some quality control by making sure all of the factor\n## levels are represented by people with and without heart disease (hd)\n##\n## NOTE: We also want to exclude variables that only have 1 or 2 samples in\n## a category since +/- one or two samples can have a large effect on the\n## odds/log(odds)\n\nxtabs(~ hd + cp, data=data)\n```\n:::\n\n\n\nKemudian kita melakukan hal yang sama untuk semua variabel `boolean` dan `categoric` yang kita gunakan untuk memprediksi penyakit jantung.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxtabs(~ hd + fbs, data=data)\nxtabs(~ hd + restecg, data=data)\n```\n:::\n\n\n\nInilah sesuatu yang dapat menyebabkan masalah pada hasil istirahat elektrokardiografi.  Hanya 4 pasien yang mewakili level 1, hal ini berpotensi menghalangi pencarian jalur yang paling pas (*fit*). Namun untuk saat ini kita hanya akan membiarkannya dan melihat apa yang terjadi dan kemudian kita terus melihat variabel yang tersisa untuk memastikan bahwa semuanya diwakili oleh sejumlah pasien. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxtabs(~ hd + exang, data=data)\nxtabs(~ hd + slope, data=data)\nxtabs(~ hd + ca, data=data)\nxtabs(~ hd + thal, data=data)\n```\n:::\n\n\n\noke kita sudah melakukan semua hal yang membosankan sekarang mari kita lakukan regresi logistik mari kita mulai dengan model yang sangat sederhana.\n\nkita akan mencoba memprediksi penyakit jantung hanya dengan menggunakan jenis kelamin setiap pasien. inilah `code call` kita ke fungsi GLM fungsi yang menjalankan **G**eneralized **L**inear **M**odels.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic <- glm(hd ~ sex, data=data, family=\"binomial\")\n```\n:::\n\n\n\npertama kita menggunakan rumus sintaks untuk menentukan bahwa kita ingin menggunakan jenis kelamin untuk memprediksi penyakit jantung. Kita ingin menggunakan jenis kelamin untuk memprediksi penyakit jantung kemudian kita menentukan data yang kita gunakan untuk model tersebut. Terakhir kita menetapkan bahwa kita menginginkan keluarga binomial dari model linier umum, hal ini membuat fungsi GLM melakukan regresi logistik dibandingkan dengan beberapa jenis model linier umum lainnya.\n\nOh, saya hampir lupa menyebutkan bahwa kita menyimpan output dari fungsi GLM dalam variabel yang disebut logistic. kita kemudian menggunakan fungsi ringkasan untuk mendapatkan detail tentang regresi logistik.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(logistic)\n\n## The intercept is the log(odds) a female will be unhealthy. This is because\n## female is the first factor in \"sex\" (the factors are ordered,\n## alphabetically by default,\"female\", \"male\")\n```\n:::\n\n\n\n1. baris pertama memiliki panggilan asli ke fungsi GLM \n2. baris kedua memberi ringkasan `deviance residuals`.\nmereka terlihat bagus karena hampir berpusat pada nol dan kira-kira simetris .\n\njika Anda ingin tahu lebih banyak tentang `deviance residuals`, lihat modul [deviance residuals](devianceresidual.qmd) yang dijelaskan dengan jelas.\n\n- kemudian kita memiliki koefisien. Mereka bersesuaiaian dengan model. \n\n$$\n\\text{heart disease} = -1.0438 + 1.2737 \\times \\text{pasien laki-laki}\n$$\nVariabel pasien laki-laki sama dengan nol ketika pasien perempuan dan satu ketika pasien laki-laki.\n\n- jadi jika kita memprediksi penyakit jantung untuk pasien wanita kita. kita mendapatkan persamaan berikut.\n\n$$\n\\text{heart disease} = -1.0438 + 1.2737 \\times 0 = -1.0438\n$$\nOleh karena itu, kemungkinan log (odds) bahwa seorang wanita memiliki penyakit jantung $ = -1.0438 $.\n\njika kita memprediksi penyakit jantung untuk pasien laki-laki, kita mendapatkan persamaan berikut\n$$\n\\text{heart disease} = -1.0438 + 1.2737 \\times 1 = -1.0438 + 1.2737\n$$\nkarena persamaan pertama adalah log(odds) seorang wanita terkena penyakit jantung, \npersamaan kedua menunjukkan peningkatan log(odds) seorang pria terkena penyakit jantung.\n\nDengan kata lain, suku persamaan kedua adalah log **rasio** peluang seorang **pria** terkena penyakit jantung terhadap kemungkinan seorang **wanita** terkena penyakit jantung. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfemale.log.odds <- log(25 / 71)\nfemale.log.odds\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfemale.log.odds <- log(25 / 71)\nfemale.log.odds\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## sexM is the log(odds ratio) that tells us that if a sample has sex=M, the\n## odds of being unhealthy are, on a log scale, 1.27 times greater than if\n## a sample has sex=F.\nmale.log.odds.ratio <- log((112 / 89) / (25/71))\nmale.log.odds.ratio\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(logistic)\n```\n:::\n\n\n\n3. Bagian `Std. Error` dan `z Value` dari keluaran regresi logistik ini menunjukkan bagaimana **Wald** dihitung untuk kedua koefisien dan ini adalah `P-Value`.\n\nkedua `P-Value` jauh di bawah 0,05 dan dengan demikian `log(odds)` dan `log(odds_ratio)` keduanya **signifikan secara statistik** tetapi ingat `P-Value` yang kecil saja tidak *menentukan*.\n\nkita juga menginginkan ukuran **efek** yang besar dan itulah yang dikatakan oleh `log(odds)` dan `log(odds_ratio)`.\n\nJika Anda ingin mengetahui detail lebih lanjut tentang \n\n- `koefisien` dan `uji Wald`, lihat [modul](regresilogistic.qmd) berikut dan \n- `log(odds)` dijelaskan dengan jelas - [`odds_ratio`](regresilogistic.qmd) dan \n- `log(odds_ratio)` dijelaskan dengan jelas dalam detail [regresi logistik bagian 1](regresilogistic.qmd).\n\n4. selanjutnya kita melihat parameter dispersi default yang digunakan untuk regresi logistik ini. \n\nKetika kita melakukan regresi linier sederhana, kita memperkirakan mean dan varians dari data yang berbeda. \n\nSecara kontras, ketika regresi logistik kita memperkirakan rata-rata data sedangkan varians diturunkan dari mean. \nKarena kita tidak memperkirakan varians dari data dan sebaliknya hanya menurunkannya dari mean ada kemungkinan varians tersebut `underestimated`. \nKalau begitu, Anda dapat menyesuaikan dispersi kita di dalam `summary` command.\n\n5. Kita memiliki `Null deviance` dan `Residual Deviance`. Ini dapat digunakan untuk membandingkan model yang menghitung `$R^2$` dan keseluruhan `p-value`.\n\nuntuk detail lebih lanjut, lihat detail [regresi logistik](regresilogistic.qmd) `$R^2$` dan `p-value`-nya dan [Saturated Models dan Deviance Statistics](regresilogistic.qmd) dijelaskan dengan jelas.\n\n6. kemudian kita memiliki AIC (Akaike Information Criterion) yang dalam konteks ini hanyalah `Residual Deviance` yang **disesuaikan** dengan jumlah parameter dalam model. **AIC** dapat digunakan untuk membandingkan satu model dengan model lainnya.\n\n7. terakhir, kita memiliki `Number of Fisher Scoring Iteration` yang hanya memberi tahu kita seberapa cepat fungsi `GLM` *coverge* pada **Maximum Likelihood Estimates** untuk koefisien.\n\njika Anda ingin detail lebih lanjut tentang bagaimana koefisien diestimasi, lihat detail [regresi logistik bagian kedua](logisticregression.qmd) **...menyesuaikan garis dengan kemungkinan maksimum**.\n\nsekarang kita telah melakukan regresi logistik sederhana hanya dengan menggunakan salah satu variabel\n(**`sex`**) untuk memprediksi penyakit jantung, kita dapat membuat model *fancy* yang menggunakan semua variabel untuk memprediksi penyakit jantung sintaks dengan rumus ini.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#####################################\n##\n## Now we will use all of the data available to predict heart disease\n##\n#####################################\n \nlogistic <- glm(hd ~ ., data=data, family=\"binomial\")\n```\n:::\n\n\n**`.`** berarti kita ingin memodelkan HD penyakit jantung menggunakan semua variabel dalam data frame kita yang disebut data, kita kemudian dapat melihat seperti apa model kita dengan fungsi `summary`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(logistic)\n```\n:::\n\n\n\nkita melihat bahwa usia bukanlah prediktor yang berguna karena memiliki `p-value` yang **besar**. Namun `rata-rata` usia dalam dataframe kita adalah $56$ tahun. Jadi sebagian besar orang sudah cukup tua dan itu menjelaskan mengapa usia tidak terlalu **berguna**.\n\n`Gender` masih merupakan prediktor yang **baik**. Meskipun begitu, kita melihat bahwa `residual deviance` dan `AIC` keduanya jauh lebih **kecil** untuk model *fancy* ini daripada fungsi untuk model sederhana yakni ketika kita hanya menggunakan **jenis kelamin** untuk memprediksi **penyakit jantung**.\n\njika kita ingin menghitung **pseudo r-squared McFadden**, kita dapat mengambil **log-likelihood null model** dari variabel **logistik**, dengan mendapatkan nilai **null deviance** dan membaginya dengan $-2$,\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Now calculate the overall \"Pseudo R-squared\" and its p-value\n \n## NOTE: Since we are doing logistic regression...\n## Null devaince = 2*(0 - LogLikelihood(null model))\n##               = -2*LogLikihood(null model)\n## Residual deviacne = 2*(0 - LogLikelihood(proposed model))\n##                   = -2*LogLikelihood(proposed model)\nll.null <- logistic$null.deviance/-2\n```\n:::\n\n\n\ndan kita dapat mengambil **log-likelihood null model** untuk model *fancy* dari variabel **logistik** dengan mendapatkan nilai **residual deviance** dan membaginya dengan $-2$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Now calculate the overall \"Pseudo R-squared\" and its p-value\n \n## NOTE: Since we are doing logistic regression...\n## Null devaince = 2*(0 - LogLikelihood(null model))\n##               = -2*LogLikihood(null model)\n## Residual deviacne = 2*(0 - LogLikelihood(proposed model))\n##                   = -2*LogLikelihood(proposed model)\nll.proposed <- logistic$deviance/-2\n```\n:::\n\n\n\nkemudian kita hanya menghitung dan kita mendapatkan **pseudo r-squared McFadden** $= 0,55$. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## McFadden's Pseudo R^2 = [ LL(Null) - LL(Proposed) ] / LL(Null)\n(ll.null - ll.proposed) / ll.null\n```\n:::\n\n\n\nini dapat diartikan sebagai ukuran **`efek` keseluruhan** dan kita dapat menggunakan **log-likelihood** yang sama untuk menghitung `p-value` untuk `$R^2$` tersebut menggunakan distribusi **Chi-Square** dalam hal ini `p-value` kecil sehingga nilai `$R^2$` bukan karena keberuntungan yang bodoh.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## chi-square value = 2*(LL(Proposed) - LL(Null))\n## The p-value for the R^2\n1 - pchisq(2*(ll.proposed - ll.null), df=(length(logistic$coefficients)-1))\n1 - pchisq((logistic$null.deviance - logistic$deviance), df=(length(logistic$coefficients)-1))\n## p-value = 1 - pchisq(chi-square value, df = 2-1)\n#1 - pchisq(2*(ll.proposed - ll.null), df=1)\n#1 - pchisq((logistic$null.deviance - logistic$deviance), df=1)\n\n## Lastly, let's  see what this logistic regression predicts, given\n## that a patient is either female or male (and no other data about them).\npredicted.data <- data.frame(\n  probability.of.hd=logistic$fitted.values,\n  sex=data$sex)\n```\n:::\n\n\n\nDetail lebih lanjut tentang `$R^2$` dan `p-value` dapat ditemukan di [logistic regression details](regresilogistic.qmd) bagian `$R^2$` dan `p-value`.\n\nTerakhir kita dapat menggambar grafik yang menunjukkan probabilitas yang diprediksi bahwa setiap pasien memiliki penyakit jantung seiring dengan status penyakit jantung yang mereka miliki.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## We can plot the data...\nggplot(data=predicted.data, aes(x=sex, y=probability.of.hd)) +\n  geom_point(aes(color=sex), size=5) +\n  xlab(\"Sex\") +\n  ylab(\"Predicted probability of getting heart disease\")\n\n## Since there are only two probabilities (one for females and one for males),\n## we can use a table to summarize the predicted probabilities.\nxtabs(~ probability.of.hd + sex, data=predicted.data)\n```\n:::\n\n\n\nSebagian besar pasien dengan penyakit jantung yang ada di warna **Turqoise** diprediksi memiliki kemungkinan Tinggi terkena penyakit jantung & Sebagian besar pasien tanpa penyakit jantung yang ada di **salmon** diprediksi memiliki kemungkinan rendah terkena penyakit jantung sehingga regresi logistik kita telah melakukan pekerjaan yang cukup baik.\n\nNamun, kita dapat menggunakan **cross validation** untuk mendapatkan ide yang lebih baik tentang seberapa baik kinerjanya dengan data baru. Tetapi kita akan menyimpannya untuk kesempatan lain.\n\n- Untuk menggambar grafik kita mulai dengan membuat data frame baru yang berisi probabilitas terkena penyakit jantung bersama dengan status penyakit jantung yang sebenarnya.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## now we can plot the data\npredicted.data <- data.frame(\n  probability.of.hd=logistic$fitted.values,\n  hd=data$hd)\n```\n:::\n\n\n\n- kemudian kita mengurutkan data frame dari probabilitas rendah ke tinggi probabilitas \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredicted.data <- predicted.data[\n  order(predicted.data$probability.of.hd, decreasing=FALSE),]\n```\n:::\n\n\n\n- kemudian kita tambahkan kolom baru ke data frame yang memiliki **rank** masing-masing sampel, dari probabilitas rendah ke probabilitas tinggi\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredicted.data$rank <- 1:nrow(predicted.data)\n```\n:::\n\n\n\n- kemudian kita memuat library `**ggplot2**` sehingga kita dapat menggambar grafik yang bagus \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n\n- kemudian kita memuat library `**cowplot**` sehingga`**ggplot2**` memiliki tampilan yang bagus secara defaults\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(cowplot)\n```\n:::\n\n\n- kemudian kita memanggil `ggplot()` dan menggunakan `geom_point()` untuk menggambar data dan\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Lastly, we can plot the predicted probabilities for each sample having\n## heart disease and color by whether or not they actually had heart disease\nggplot(data=predicted.data, aes(x=rank, y=probability.of.hd)) +\n  geom_point(aes(color=hd), alpha=1, shape=4, stroke=2) +\n  xlab(\"Index\") +\n  ylab(\"Predicted probability of getting heart disease\")\n```\n:::\n\n\n\n- terakhir kita memanggil `ggsave()` untuk menyimpan grafik sebagai file PDF triple.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"heart_disease_probabilities.pdf\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}