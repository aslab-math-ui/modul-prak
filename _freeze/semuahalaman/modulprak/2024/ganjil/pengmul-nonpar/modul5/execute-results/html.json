{
  "hash": "77287f951c45d1aa50f9a2f3dcc1f4c8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pertemuan 5: Uji Beda Mean Data Multivariat\"\nsubtitle: \"Pengantar Multivariat\"\nimage: static\\soal1_bedamean.png\ndescription: \"Offline di Departemen Matematika\"\ndate: 11/12/2024\npage-navigation: true\nformat: html\n---\n\n\n\n# Review Uji Beda Mean 1 Sampel Univariat\n\nDalam uji beda mean 1 sampel univariat, hipotesis yang ingin kita uji adalah\n\n| $H_0: \\mu = \\mu_0$\n| $H_1: \\mu \\neq \\mu_0$\n\ndengan $\\mu_0$ adalah nilai mean yang ditentukan.\n\n## Ketika Variansi Diketahui\n\nAsumsi n observasi sampel acak $y_1, y_2, ..., y_n$ berdistribusi $N(\\mu,\\sigma^2)$ dengan $\\sigma^2$ diketahui, maka digunakan statistik uji $z$ yaitu\n\n![](static\\z_univ_known.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $|z| \\geq z_{\\alpha/2}$\n\nAtau dengan distribusi chi-square\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $z^2 \\geq \\chi^2_{\\alpha, 1}$\n\n### Implementasi Program\n\nUji $z$ dapat dilakukan dengan memanggil fungsi `z.test()` pada r dari library `BSDA`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(BSDA)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(88, 92, 94, 94, 96, 97, 97, 97, 99, 99, 105, 109, 109, 109, 110, 112, 112, 113, 114, 115)\nz.test(data, mu = 100, sigma.x = 15)\n```\n:::\n\n\n\n## Ketika Variansi Tidak Diketahui\n\nKetika variansi tidak diketahui, gunakan estimasi sampel dari $\\sigma^2$ yaitu $s^2$, di mana\n\n![](static\\sample_var_univ.png)\n\nUji yang digunakan adalah uji $t$, dengan statistik uji:\n\n![](static\\t_univ_unknown.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $|t| \\geq t_{\\alpha/2, n-1}$\n\n### Implementasi Program\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(88, 92, 94, 94, 96, 97, 97, 97, 99, 99, 105, 109, 109, 109, 110, 112, 112, 113, 114, 115)\n\nt.test(data, mu=100)\n```\n:::\n\n\n\n# Uji Beda Mean 1 Sampel Multivariat\n\nDalam uji beda mean 1 sampel multivariat, hipotesis yang ingin kita uji adalah\n\n| $H_0: \\pmb{\\mu} = \\pmb{\\mu_0}$\n| $H_1: \\pmb{\\mu} \\neq \\pmb{\\mu_0}$\n\ndengan $\\pmb{\\mu_0}$ adalah vektor mean yang ditentukan.\n\n## Ketika Variansi Diketahui\n\nAsumsi n vektor observasi sampel acak $\\pmb{y}_1, \\pmb{y}_2, ..., \\pmb{y}_n$ berdistribusi $N_p(\\pmb{\\mu},\\pmb{\\Sigma})$ dengan $\\pmb{\\Sigma}$ diketahui, maka digunakan statistik uji $Z^2$ yaitu\n\n![](static\\z_multiv_known.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $Z^2 > \\chi^2_{\\alpha, p}$\n\n### Implementasi Program\n\nDigunakan data dari tabel 3.7 (Ramus Bone) dari buku *Methods of Multivariate Analysis by Alvin C. Rencher, William F. Christensen. 3rd Edition*\n\nMisalkan ingin diuji apakah $(\\mu_1, \\mu_2, \\mu_3, \\mu_4) = (48, 49, 50, 51)$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv('https://raw.githubusercontent.com/farhanage/dataset-for-study/refs/heads/main/Analisis%20Multivariat/Tabel%203.7%20(Ramus%20Bone%20Length%20at%20Four%20Ages%20).csv', sep=';')[2:5]\n\nhead(data)\n```\n:::\n\n\n\nMisalkan diketahui $\\pmb{\\Sigma}$ adalah matrix diagonal dengan entri-entri diagonalnya bernilai 3.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- c(48, 49, 50, 51)\nn <- nrow(data)\np <- length(mu)\n\nybar <- colMeans(data)\nSigma <- diag(3, ncol=4, nrow=4)\n```\n:::\n\n\n\nMaka hitung statistik uji:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nZ_sq <- n * t(ybar-mu) %*% solve(Sigma) %*% (ybar-mu)\nZ_sq\nqchisq(p=0.05, df=p, lower.tail = FALSE)\n```\n:::\n\n\n\nApa kesimpulannya?\n\n## Ketika Variansi Tidak Diketahui\n\nKetika variansi tidak diketahui, gunakan estimasi sampel dari $\\pmb{\\Sigma}$ yaitu $\\textbf{S}$, di mana\n\n![](static\\sample_var_multiv1.png)\n![](static\\sample_var_multiv2.png)\n\nUji yang digunakan adalah uji *Hotelling's* $T^2$, dengan statistik uji:\n\n![](static\\t_multiv_unknown.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $T^2 > T^2_{\\alpha, p, n-1}$\n\nStatistik uji $T^2$ dapat dibawa ke distribusi $F$ dengan hubungan:\n\n![](static\\tsq_f.png)\n\nDalam uji beda mean 1 sampel, nilai $v$ adalah $n-1$\n\n### Implementasi Program\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nS <- cov(data)\n\nT2 <- n * t(ybar - mu) %*% solve(S) %*% (ybar - mu)\nT2\n```\n:::\n\n\n\nCek nilai tabel $T^2_{\\alpha, p, n-1}$ di buku\n\nAtau dengan Pendekatan distribusi F\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nF <- (n - p)/(n*p - p)*T2\nF\n\n# Titik kritis f\nqf(0.05, p, n-p, lower.tail = FALSE)\n\n# Pvalue f\npf(F, p, n - p, lower.tail = FALSE)\n\n# Titik kritis T^2\n((n*p - p)/(n - p))*qf(0.05, p, n-p, lower.tail = FALSE)\n```\n:::\n\n\n\nApa kesimpulannya?\n\n::: {.callout-tip}\n## Hotelling's $T^2$ Dengan Library\n\nPenggunaan library kurang disarankan untuk pengerjaan karena proses penghitungan tidak terlihat, tetapi penggunaan library ini bagus untuk crosschecking jawaban kalian.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nICSNP::HotellingsT2(data, mu = mu, test = \"f\")\n```\n:::\n\n\n\n(Pastikan install library `ICSNP`)\n\n:::\n\n# Uji Beda Mean 2 Sampel Multivariat Independen\n\nDalam uji beda mean 2 sampel multivariat saling independen, hipotesis yang ingin kita uji adalah\n\n| $H_0: \\pmb{\\mu_1} = \\pmb{\\mu_2}$\n| $H_1: \\pmb{\\mu_1} \\neq \\pmb{\\mu_2}$\n\ndengan $\\pmb{\\mu_1}$, $\\pmb{\\mu_2}$ adalah vektor mean dari variabel-variabel sampel acak yang ingin diuji.\n\nStatistik uji yang digunakan adalah:\n\n![](static\\Tsq_2sample.png)\n\ndengan\n\n![](static\\spl.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $T^2 \\geq T^2_{\\alpha, p, n_1+n_2-2}$\n\natau dengan pendekatan distribusi $F$\n\n![](static\\tsq_to_f_2sample.png)\n\n### Implementasi Program\n\nGunakan tabel 5.9\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv('https://raw.githubusercontent.com/farhanage/dataset-for-study/refs/heads/main/Analisis%20Multivariat/Tabel%205.9%20(Number%20of%20Words%20and%20Number%20of%20Verbs).csv', sep=';')\n\ndata\n```\n:::\n\n\n\nAkan diuji\n\n| $H_0: \\pmb{\\mu_y} = \\pmb{\\mu_x}$\n| $H_1: \\pmb{\\mu_y} \\neq \\pmb{\\mu_x}$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- data[, 2:3]\ny\n\nx <- data[, 4:5]\nx\n\nn1 <- nrow(y)\nn2 <- nrow(x)\np <- length(y)\n\n# Vektor xbar ybar\nybar <- colMeans(y)\nybar\n\nxbar <- colMeans(x)\nxbar\n\n# Matriks Sx dan Sy\nSy <- cov(y)\nSy\n\nSx <- cov(x)\nSx\n\n# Hitung Spl\nSpl <- 1/(n1 + n2 - 2) * ((n1 - 1) * Sy + (n2 - 1) * Sx)\nSpl\n\n# Hitung T^2\nT2 <- (n1 * n2)/(n1 + n2) * t(ybar - xbar) %*% solve(Spl) %*% (ybar - xbar)\nT2\n```\n:::\n\n\n\nAtau dengan bantuan library `DescTools`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DescTools)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nHotellingsT2Test(y, x, test='chi')\n```\n:::\n\n\n\n## Uji t 2 Sampel Univariat Ketika H0 Ditolak\n\nKetika $H_0$ ditolak, gunakan uji t 2 sampel pada masing-masing variabel\n\n| $H_0: \\mu_1 = \\mu_2$\n| $H_1: \\mu_1 \\neq \\mu_2$\n\ndengan statistik uji\n\n![](static\\t_sample_univ.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $|t| > t_{\\alpha/2, n_1+n_2-2}$\n\n### Implementasi Kode\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_values <- c()\np_values <- c()\n\nfor (i in 1:ncol(y)){\n  test <- t.test(y[, i], x[, i], mu=0, var.equal=TRUE)\n  t_values[i] <- test$statistic\n  p_values[i] <- test$p.value\n}\n\nt_values\n\n# t penolakan\nqt(0.025, n1+n2-2, lower.tail = FALSE)\n\np_values\n```\n:::\n\n\n\nKesimpulannya?\n\n# Uji Beda Mean 2 Sampel Berpasangan Multivariat\n\nTinjau data tabel 5.9 sebagai data berpasangan $(\\pmb{y}, \\pmb{x})$ di mana y dan x saling berkorelasi (dependen)\n\ndapat dihitung selisih dari tiap variabel yang diukur ($d$):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$d1 <- data$y1 - data$x1\ndata$d2 <- data$y2 - data$x2\ndata\n```\n:::\n\n\n\nUntuk menguji\n\n| $H_0: \\pmb{\\mu_y} = \\pmb{\\mu_x}$\n| $H_1: \\pmb{\\mu_y} \\neq \\pmb{\\mu_x}$\n\nekivalen dengan menguji\n\n| $H_0: \\pmb{\\mu_d} = \\pmb{0}$\n| $H_1: \\pmb{\\mu_d} \\neq \\pmb{0}$\n\nMenggunakan statistik uji\n\n![](static/tsq_paired.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $T^2 > T^2_{\\alpha, p, n-1}$\n\n### Implementasi Kode\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- y - x\nd\n\ndbar <- colMeans(d)\ndbar\n\nSd <- cov(d)\nSd\n\nn <- nrow(d)\np <- length(d)\n\n# Hitung T^2\nT2 <- n * t(dbar) %*% solve(Sd) %*% dbar\nT2\n```\n:::\n\n\n\n# Latihan Soal\n\n![](static\\soal1_bedamean.png)\n\n![](static\\soal2_bedamean.png)",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}