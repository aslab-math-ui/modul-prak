{
  "hash": "d01c0a7a0b0d6466ca2e89becdd32299",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pertemuan 6: Uji Randomization, Mann-Whitney, Smirnov, Squared Rank\"\nsubtitle: \"Statistika Nonparametrik\"\nimage: static\\tabelmannwhitney.png\ndescription: \"Offline di Departemen Matematika\"\ndate: 11/19/2024\npage-navigation: true\nformat: html\n---\n\n\n\n# Tabel Guide Uji Nonparametrik\n\n![](static\\tabelconover1.png)\n\n![](static\\tabelconover2.png)\n\n# Fisher's Randomization\n\n1. A tire company did a follow-up study on ten customers, randomly selected from those who had purchased new tires from them three years earlier, and asked them how many times they had encountered tire failure from any cause, such as nails, valve, leakage, etc. The study was restricted to two lines of long-life tires, called Brand A dan Bran B. These were their results. \n\n|Customer|Brand A|Brand B|\n|---|---|---|\n|1|0|3|\n|2|2|5|\n|3|0|1|\n|4|1|4|\n|5|2|3|\n\nUse Fisher‚Äôs randomization method to get the exact ùëù-value for testing the null hypothesis of equal likelihood for tire failure, against the two sided alternative, that is, either Brand A or Brand B tends to have fewer tair values and a one-sided alternative that Brand A tends to have fewer tire failures. \n\n- Two Sided Alternative\n\n| $H_0: E(X) = E(Y)$\n| $H_1: E(X) \\neq E(Y)$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Bentuk vektor\nA <- c(0, 2, 0, 1, 2)\nB <- c(3, 5, 1, 4, 3)\n\n## Hitung dimensi\nn <- length(A)\nm <- length(B)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Bentuk list\nX <- rep(\"X\", n)\nY <- rep(\"Y\", m)\ngroup <- c(X,Y)\ngroup\n```\n:::\n\n\n\nDapat dicari semua kombinasi X dan Y dari group di atas menggunakan fungsi `combn()` dari library `combinat`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"combinat\")\nlibrary(combinat) \n\n## Hitung kombinasi\ncombn(group, n)\n```\n:::\n\n\n\nSehingga jumlah kombinasi yang mungkin\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_kombinasi <- ncol(combn(group, n))\nn_kombinasi\n```\n:::\n\n\n\nDidapat jumlah kelompok yang perlu dibentuk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Hitung jumlah kelompok\nround(n_kombinasi * 0.025)\n```\n:::\n\n\n\nKombinasi jumlah kelompok yang mungkin\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Bentuk kombinasi\nkombinasi <- unique(permn(group))\n```\n:::\n\n\n\nGabungkan nilai-nilai yang mungkin dan urutkan dari yang terkecil\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsorted_values <- sort(c(A,B))\nsorted_values\n```\n:::\n\n\n\nFungsi Fisher's Randomization from *scratch*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisher_randomization <- function(kombinasi, sorted_values){\n    result <- data.frame()\n\n    for (i in 1:length(kombinasi)){\n        T <- 0\n        for (j in 1:length(kombinasi[[i]])){ \n            if (kombinasi[[i]][j] == 'X'){\n                T <- T + sorted_values[j]\n            } \n        }\n        temp_df <- data.frame(matrix(c(kombinasi[[i]], T), nrow=1))\n        result <- rbind(result, temp_df)\n    }\n    colnames(result) <- c(paste0(sorted_values), \"T\")\n    result$T <- as.numeric(result$T) \n    result <- result[order(result$T), ]\n    rownames(result) <- NULL\n    \n    return(result)\n}  \n\nresult <- fisher_randomization(kombinasi, sorted_values)\nhead(result, n=6L)\n```\n:::\n\n\n\nMaka didapat nilai T terbesar ($w_{0.025}$) = 5\n\nTolak $H_0$ pada tingkat $\\alpha$ jika $T_1 > W_{1-\\alpha/2}$ atau $T_1 < W_{\\alpha/2}$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nT1 <- sum(A)\nT1\n```\n:::\n\n\n\nKesimpulannya?\n\nHitung exact p-value:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nless_T1 <- result[result$T < 5, 'T']\nless_T1\n\np_val <- 2 *  sum(less_T1)/ n_kombinasi\np_val\n```\n:::\n\n\n\nKesimpulannya?\n\n- One Sided Alternative\n\nUse $w_{0.05}$ and reject $H_0$ when $T_1 < w_{0.05}$\n\n## Latihan Soal\n\n2. A random sample of eight adults were asked how old they were when they went on their first date. The three men responded with ages 15, 17, 16, while the five women answered 12, 14, 15, 10, and 12. Test the hypothesis that the average is the same for both sexes against the alternative that girls tend to be younger on the occasion of their first date.\n\n# Uji Mann-Whitney\n\n1. The senior class in a particular high school had 48 boys. Twelve boys lived on farms and the other 36 lived in town. A test was devised to see if farm boys in general were more physically fit than town boys. Each boy in the class was given a physical fitness test in which a low score indicates poor physical condition. The scores of the farm boys ($X_i$) and the town boys ($Y_i$) are as follows. \n\n![](static\\tabelmannwhitney.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Bentuk vektor dari setiap grup\nfarm <- c(14.8, 7.3, 5.6, 6.3, 9, 4.2, 10.6, 12.5, 12.9, 16.1, 11.4, 2.7) #x\ntown <- c(12.7, 14.2, 12.6, 2.1, 17.7, 11.8, 16.9, 7.9, 16, 10.6, 5.6, 5.6, 7.6,\n          11.3, 8.3, 6.7, 3.6, 1, 2.4, 6.4, 9.1, 6.7, 18.4, 3.2, 6.2, 6.1, 15.3,\n          10.6, 1.8, 5.9, 9.9, 10.6, 14.8, 5, 2.6, 4) #y\n```\n:::\n\n\n\nBentuk tabel untuk menghitung rank\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Lakukan dengan uji manual\n### Farm\ntemp <- farm\ncategory <- rep(\"Farm\", length(temp))\ndf1 <- data.frame(temp, category) \n\n### Town\ntemp <- town\ncategory <- rep(\"Town\", length(temp))\ndf2 <- data.frame(temp, category)\n\n### Gabungan\ndf <- rbind(df1, df2)\ndf <- df[order(df$temp), ]\ndf$rank <- rank(df$temp)\ndf$x <- ifelse(df$category == \"Farm\", df$temp, 0)\ndf$y <- ifelse(df$category == \"Town\", df$temp, 0)\n\ndf\n```\n:::\n\n\n\nHitung Statistik Uji\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Statistik Uji\n(T.stat <- sum(df[df$category == \"Farm\", ]$rank))\nn <- length(farm)\nm <- length(town)\nN <- n + m\nr_sq <- sum(df$rank^2)\nr_sq\n\nT1 <- (T.stat - n*((N + 1)/2))/sqrt((n*m*r_sq/(N*(N - 1)) - n*m*(N + 1)^2/(4*(N - 1)))) \nT1\n```\n:::\n\n\n\n- Upper tailed, H0 ditolak: $T_1 > z_{1-\\alpha}$\n- Lower tailed, H0 ditolak: $T_1 < z_\\alpha$\n- Two tailed, H0 ditolak: $T_1 < z_{\\alpha/2}$ atau $T_1 > z_{1-\\alpha/2}$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Upper Tail - Kuantil ke 0.95 dari N(0,1)\nqnorm(.95)\n```\n:::\n\n\n\nKesimpulannya?\n\n## Latihan Soal\n\n2. Misalkan terdapat suatu klaim yang mengatakan bahwa tanaman A memiliki khasiat dalam membantu mengurangi gejala medis suatu penyakit sistem pencernaan manusia. Kemudian, Anda diminta untuk mengecek kebenaran mengenai klaim tersebut. Setelah beberapa saat, Anda mendapatkan data mengenai 20 pasien penyakit pencernaan sebagai berikut! \n\n|Kontrol|3|6|4|5|5|8|6|5|7|2|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Obat A|2|3|1|4|7|5|5|4|2|1|\n\nDalam kasus ini, apa uji yang cocok untuk melihat signifikansi perbedaan antara pasien kelompok kontrol dengan pasien yang diberikan obat dari tanaman A? Apa saja asumsi yang perlu dipenuhi uji yang Anda pilih? Lakukanlah uji yang Anda pilih tersebut! Definisikan secara lengkap hipotesis, prosedur uji statistik, hingga keputusan dan kesimpulan yang dapat diambil dari uji tersebut! Gunakan taraf signifikansi 0.05!\n\n# Uji Smirnov\n\n1. Manajer sumber daya alam telah mencoba menggunakan Satellite Landsat Multispectral Scanner data untuk klasifikasi tutupan lahan yang lebih baik. Saat satelit itu diketahui terbang di atas wilayah yang berupa hutan, intensitas cahaya dibaca kemudian direkam pada pita inframerah. Diperoleh sampel yang sudah diurut seperti berikut: \n\n\n77 77 78 78 81 81 82 82 82 82 82 83 83 84 84 84 84 85 86 86 86 86 86 87 87 87 87 87 87 87 89 89 89 89 89 89 89 90 90 90 91 91 91 91 91 91 91 91 91 91 93 93 93 93 93 93 94 94 94 94 94 94 94 94 94 94 94 94 95 95 95 95 95 96 96 96 96 96 96 97 97 97 97 97 97 97 97 97 98 99 100 100 100 100 100 100 100 100 100 101 101 101 101 101 101 102 102 102 102 102 102 103 103 104 104 104 105 107 \n\n\nSaat satelit itu terbang di atas wilayah perkotaan, intensitas cahaya yang dipantulkan oleh pita infra merah yang telah diurut seperti berikut: \n\n\n71 72 73 74 75 77 78 79 79 79 79 80 80 80 81 81 81 82 82 82 82 84 84 84 84 84 84 85 85 85 85 85 85 86 86 87 88 90 91 94 \n\n\nJika arti pembacaan berbeda, maka bacaan tersebut dapat digunakan untuk membedakan intensitas wilayah perkotaan dari kawasan hutan\n\nUji kolmogorov-smirnov dapat dilakukan dengan memanggil fungsi `ks.test()` dari library `dgof`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"dgof\")\nlibrary(dgof)\n\nhutan <- c(77, 77, 78, 78, 81, 81, 82, 82, 82, 82, 82, 83, 83, 84, 84, 84, 84,\n           85, 86, 86, 86, 86, 86, 87, 87, 87, 87, 87, 87, 87, 89, 89, 89, 89,\n           89, 89, 89, 90, 90, 90, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 93,\n           93, 93, 93, 93, 93, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94, 94,\n           95, 95, 95, 95, 95, 96, 96, 96, 96, 96, 96, 97, 97, 97, 97, 97, 97,\n           97, 97, 97, 98, 99, 100, 100, 100, 100, 100, 100, 100, 100, 100, 101,\n           101, 101, 101, 101, 101, 102, 102, 102, 102, 102, 102, 103, 103, 104,\n           104, 104, 105, 107)\nkota <- c(71, 72, 73, 74, 75, 77, 78, 79, 79, 79, 79, 80, 80, 80, 81, 81, 81,\n          82, 82, 82, 82, 84, 84, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 86,\n          86, 87, 88, 90, 91, 94)\n\nks.test(hutan, kota, alternative = 'two.sided')\n```\n:::\n\n\n\n\n## Latihan Soal\n\n2. Diet A was given to four overweight girls and diet B was given to five other overweight girls, with the following observed weight losses. Find a 90% confidence interval for mean difference in effectiveness of the two diets.\n\n|Diet |Weight Losses (pounds)|\n|---|---|\n|A |7, 2, -1, 4|\n|B |6, 5, 2, 8, 3|\n\n# Uji Squared Rank\n\n1. Suatu perusahaan pengemasan makanan ingin mengetahui apakah kotak sereal yang diproduksi benar-benar mengandung setidaknya sesuai dengan sejumlah ons sereal yang tertera di kemasan. Dalam hal ini, harus ditentukan jumlah rata-rata per kotak sedikit lebih banyak dari jumlah yang tertera karena variasi yang disebabkan oleh mesin pengemas yang terkadang memasukkan sereal dengan jumlah yang lebih sedikit atau lebih banyak. Mesin dengan variasi yang lebih kecil akan lebih menguntungkan perusahaan karena jumlah sereal yang dimasukkan bisa lebih mendekati jumlah yang ditentukan. Sebuah mesin baru diuji untuk dilihat apakah memiliki variansi yang lebih kecil dari mesin yang lama. Beberapa kotak diisi sereal dengan mesin yang lama kemudian jumlah sereal pada setiap kotak diukur. Hal yang sama dilakukan pada mesin yang baru. Didapat data sebagai berikut \n\n|Present (X)|10,8|11,1|10,4|10,1|11,3|||\n|---|---|---|---|---|---|---|---|\n|New (Y)|10,8|10,5|11|10,9|10,8|10,7|10,8|\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Bentuk vektor\npresent <- c(10.8, 11.1, 10.4, 10.1, 11.3) #X\nnew <- c(10.8, 10.5, 11, 10.9, 10.8, 10.7, 10.8) #Y\n\n## Present\ntemp <- present\nXbar <- mean(temp)\ncategory <- rep(\"Present\", length(temp))\ntemp_absdev <- abs(temp - mean(temp))\ndf1 <- data.frame(temp, category, temp_absdev) \n\n## New\ntemp <- new\nYbar <- mean(temp)\ncategory <- rep(\"New\", length(temp))\ntemp_absdev <- abs(temp - mean(temp))\ndf2 <- data.frame(temp, category, temp_absdev)\n\n## Gabungan\ndf <- rbind(df1, df2)\ndf <- df[order(df$temp_absdev), ]\ndf$rank <- rank(df$temp_absdev)\ndf$sqrank <- rank(df$temp_absdev)^2\n\n## Statistik Uji\nT.stat <- sum(df[df$category == \"Present\", ]$sqrank)\nn <- length(present)\nm <- length(new)\nN <- n + m\nrsq_bar <- mean(df$sqrank)\nr_qt <- sum(df$sqrank^2)\n\nT1 <- (T.stat - n*rsq_bar)/sqrt(n*m*r_qt/(N*(N-1)) - n*m*(rsq_bar^2)/(N-1))\nT1\n```\n:::\n\n\n\n- Upper tailed, H0 ditolak: $T_1 > z_{1-\\alpha}$\n- Lower tailed, H0 ditolak: $T_1 < z_\\alpha$\n- Two tailed, H0 ditolak: $T_1 < z_{\\alpha/2}$ atau $T_1 > z_{1-\\alpha/2}$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Upper Tail - Kuantil ke 0.95 dari N(0,1)\nqnorm(.95)\n```\n:::\n\n\n\nKesimpulannya?\n\n## Latihan Soal\n\n2. A blood bank kept a record of the rate of heartbeats for several blood donors. \n\n|Men|Women|\n|---|---|\n|58|66|\n|76|74|\n|82|69|\n|74|76|\n|79|72|\n|65|73|\n|74|75|\n|86|67|\n||68|\n\nIs the variation among the men significantly greater than the variation among women?",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}