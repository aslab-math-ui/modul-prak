{
  "hash": "11532e5915ab4e568d89741c1ddb64f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pertemuan 7: MANOVA\"\nsubtitle: \"Pengantar Multivariat\"\nimage: static\\fstat_anova.png\ndescription: \"Offline di Departemen Matematika\"\ndate: 11/26/2024\npage-navigation: true\nformat: html\n---\n\n\n\n# ANOVA\n\nHipotesis\n\n$H_0: \\mu_1 = \\mu_2 = ... = \\mu_k$\n\n$H_1: \\text{Tidak Demikian}$\n\nStatistik Uji:\n\n![](static\\fstat_anova.png)\n\nAturan Penolakan:\n\nTolak $H_0$ pada tingkat $\\alpha$ jika $F > F_\\alpha$\n\n## Manual\n\nKita akan menggunakan data dari tabel 6.2 buku Rencher (Rootstock Data)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.delim(\"https://raw.githubusercontent.com/kmyafi/Multivariate-Statistics-R/main/Data/T6_2_ROOT.DAT\",\n                 sep = \"\", header = FALSE)\ncolnames(df) <- c('Rootstock', 'y1', 'y2', 'y3', 'y4')\ndf\n```\n:::\n\n\n\nPastikan tipe data variabel yang menyatakan anggota kelompok sebagai `factor`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$Rootstock <- as.factor(df$Rootstock)\n```\n:::\n\n\n\nMisalkan ingin diuji apakah mean dari variabel y1 sama untuk setiap kelompok.\n\nAkan dicari nilai $n_k$, $\\bar{y}_{1k}$ dan vektor mean $\\bf{\\bar{y}_1}$ untuk menghitung nilai statistik uji $F$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Jumlah Group\nk <- 6\n\nn1 <- nrow(df[df$Rootstock == \"1\", ])\nn2 <- nrow(df[df$Rootstock == \"2\", ])\nn3 <- nrow(df[df$Rootstock == \"3\", ])\nn4 <- nrow(df[df$Rootstock == \"4\", ])\nn5 <- nrow(df[df$Rootstock == \"5\", ])\nn6 <- nrow(df[df$Rootstock == \"6\", ])\n\nmean1 <- mean(as.matrix(df[df$Rootstock == \"1\", \"y1\"]))\nmean2 <- mean(as.matrix(df[df$Rootstock == \"2\", \"y1\"]))\nmean3 <- mean(as.matrix(df[df$Rootstock == \"3\", \"y1\"]))\nmean4 <- mean(as.matrix(df[df$Rootstock == \"4\", \"y1\"]))\nmean5 <- mean(as.matrix(df[df$Rootstock == \"5\", \"y1\"]))\nmean6 <- mean(as.matrix(df[df$Rootstock == \"6\", \"y1\"]))\n\noverallMean <- mean(df$y1)\n\nSSH <- sum(n1 * (mean1 - overallMean)^2 + \n             n2 * (mean2 - overallMean)^2 + \n             n3 * (mean3 - overallMean)^2 +\n             n4 * (mean4 - overallMean)^2 +\n             n5 * (mean5 - overallMean)^2 +\n             n6 * (mean6 - overallMean)^2); SSH\n\nMSH <- SSH/(k-1); MSH\n\nSSE <- sum(c((as.matrix(df[df$Rootstock == \"1\", \"y1\"]) - mean1)^2,\n             (as.matrix(df[df$Rootstock == \"2\", \"y1\"]) - mean2)^2,\n             (as.matrix(df[df$Rootstock == \"3\", \"y1\"]) - mean3)^2,\n             (as.matrix(df[df$Rootstock == \"4\", \"y1\"]) - mean4)^2,\n             (as.matrix(df[df$Rootstock == \"5\", \"y1\"]) - mean5)^2,\n             (as.matrix(df[df$Rootstock == \"6\", \"y1\"]) - mean6)^2)); SSE\n\nMSE <- SSE/(k*(n1-1)) ; MSE\n\nFvalue <- MSH/MSE; Fvalue\n```\n:::\n\n\n\nBandingkan dengan nilai $F$ tabel\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqf(0.95, k-1, k*(n1-1))\n```\n:::\n\n\n\nAtau p-value\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npf(Fvalue, k-1, k*(n1-1), lower.tail = FALSE)\n```\n:::\n\n\n\nKesimpulannya?\n\n## Fungsi `aov()`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_result <- aov(df$y1 ~ df$Rootstock, data = df)\nsummary(anova_result)\n```\n:::\n\n\n\nApakah sama?\n\n# MANOVA\n\nHipotesis:\n\n$H_0: \\bf{\\mu_1} = \\bf{\\mu_2} = ... = \\bf{\\mu_k}$\n\n$H_1: \\text{Tidak Demikian}$\n\n## Manual\n\nDengan data yang sama, akan diuji apakah $\\bf{\\mu_1} = \\bf{\\mu_2} = ... = \\bf{\\mu_k}$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- cbind(df$y1,df$y2,df$y3,df$y4); y\n\ntotalmeans <- colMeans(y); totalmeans\n\nn <- dim(df)[1] / length(unique(df$Rootstock)); n\n\ndf.group <- split(df[,2:5], df$Rootstock)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.means <- sapply(df.group, function(x) {\n  apply(x, 2, mean)\n}, simplify = 'data.frame')\n\ndf.means\n```\n:::\n\n\n\n### Matriks H\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Matriks H ----\nH <- matrix(data = 0, nrow = 4, ncol = 4)\nfor (i in 1:dim(H)[1]) {\n  for (j in 1:i) {\n    H[i,j] <- n * sum((df.means[i,] - totalmeans[i]) * (df.means[j,] - totalmeans[j]))\n    H[j,i] <- n * sum((df.means[j,] - totalmeans[j]) * (df.means[i,] - totalmeans[i]))\n  }\n}\nH\n```\n:::\n\n\n\n### Matriks E\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Matriks E ----\nE <- matrix(data = 0, nrow = 4, ncol = 4)\nfor (i in 1:dim(E)[1]) {\n  for (j in 1:i) {\n    b <- c() \n    for (k in df.group) {\n      a <- sum((k[,i] - mean(k[,i])) * (k[,j] - mean(k[,j])))\n      b <- append(b, a)\n    }\n    E[i,j] <- sum(b)\n    E[j,i] <- sum(b)\n  }\n}\nE\n```\n:::\n\n\n\n## Fungsi `manova()`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmanova_result <- manova(cbind(y1,y2,y3,y4) ~ Rootstock, data = df)\n```\n:::\n\n\n\n## Wilk's Lambda\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\nLambda <- det(E)/det(E + H); Lambda\n\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Wilks\")\n```\n:::\n\n\n\n## Roy's Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\nEinvH.eigen <- eigen(solve(E) %*% H)\nroy.stat <- EinvH.eigen$values[1]; roy.stat\ntheta <- roy.stat/(1+roy.stat); theta\n\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Roy\")\n```\n:::\n\n\n\n## Pillai Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\npillai.stat <- sum(diag(solve(E + H) %*% H)); pillai.stat\nsum(EinvH.eigen$values / (1 + EinvH.eigen$values))\n\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Pillai\")\n```\n:::\n\n\n\n## Lawley-Hotelling Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\nlawhot.stat <- sum(diag(solve(E) %*% H)); lawhot.stat\nsum(EinvH.eigen$values)\n\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Hotelling-Lawley\")\n```\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}